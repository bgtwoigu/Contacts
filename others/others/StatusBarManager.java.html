<html>
<head>
  <title>StatusBarManager.java</title>
  <basefont face="Microsoft YaHei" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/301769 (zh-CN); Windows/6.3.9600 (Win64);"/>
  <style>
    body, td {
      font-family: Microsoft YaHei;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1733"/>
<h1>StatusBarManager.java</h1>

<div>
<span><div>/*</div><div>* Copyright (C) 2014 MediaTek Inc.</div><div>* Modification based on code covered by the mentioned copyright</div><div>* and/or permission notice(s).</div><div>*/</div><div>/*</div><div> * Copyright (C) 2007 The Android Open Source Project</div><div> *</div><div> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</div><div> * you may not use this file except in compliance with the License.</div><div> * You may obtain a copy of the License at</div><div> *</div><div> *      http://www.apache.org/licenses/LICENSE-2.0</div><div> *</div><div> * Unless required by applicable law or agreed to in writing, software</div><div> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div> * See the License for the specific language governing permissions and</div><div> * limitations under the License.</div><div> */</div><div><br/></div><div><br/></div><div>package android.app;</div><div><br/></div><div>import android.content.ComponentName;</div><div>import android.content.Context;</div><div>import android.os.Binder;</div><div>import android.os.RemoteException;</div><div>import android.os.IBinder;</div><div>import android.os.ServiceManager;</div><div>import android.util.Slog;</div><div>import android.view.View;</div><div><br/></div><div>import com.android.internal.statusbar.IStatusBarService;</div><div>import com.mediatek.xlog.Xlog;</div><div><br/></div><div>/**</div><div> * Allows an app to control the status bar.</div><div> *</div><div> * @hide</div><div> */</div><div>public class StatusBarManager {</div><div><br/></div><div>    public static final int DISABLE_EXPAND = View.STATUS_BAR_DISABLE_EXPAND;</div><div>    public static final int DISABLE_NOTIFICATION_ICONS = View.STATUS_BAR_DISABLE_NOTIFICATION_ICONS;</div><div>    public static final int DISABLE_NOTIFICATION_ALERTS</div><div>            = View.STATUS_BAR_DISABLE_NOTIFICATION_ALERTS;</div><div>    @Deprecated</div><div>    public static final int DISABLE_NOTIFICATION_TICKER</div><div>            = View.STATUS_BAR_DISABLE_NOTIFICATION_TICKER;</div><div>    public static final int DISABLE_SYSTEM_INFO = View.STATUS_BAR_DISABLE_SYSTEM_INFO;</div><div>    public static final int DISABLE_HOME = View.STATUS_BAR_DISABLE_HOME;</div><div>    public static final int DISABLE_RECENT = View.STATUS_BAR_DISABLE_RECENT;</div><div>    public static final int DISABLE_BACK = View.STATUS_BAR_DISABLE_BACK;</div><div>    public static final int DISABLE_CLOCK = View.STATUS_BAR_DISABLE_CLOCK;</div><div>    public static final int DISABLE_SEARCH = View.STATUS_BAR_DISABLE_SEARCH;</div><div><br/></div><div>    @Deprecated</div><div>    public static final int DISABLE_NAVIGATION = </div><div>            View.STATUS_BAR_DISABLE_HOME | View.STATUS_BAR_DISABLE_RECENT;</div><div><br/></div><div>    public static final int DISABLE_NONE = 0x00000000;</div><div><br/></div><div>    public static final int DISABLE_MASK = DISABLE_EXPAND | DISABLE_NOTIFICATION_ICONS</div><div>            | DISABLE_NOTIFICATION_ALERTS | DISABLE_NOTIFICATION_TICKER</div><div>            | DISABLE_SYSTEM_INFO | DISABLE_RECENT | DISABLE_HOME | DISABLE_BACK | DISABLE_CLOCK</div><div>            | DISABLE_SEARCH;</div><div><br/></div><div>    public static final int NAVIGATION_HINT_BACK_ALT      = 1 &lt;&lt; 0;</div><div>    public static final int NAVIGATION_HINT_IME_SHOWN     = 1 &lt;&lt; 1;</div><div><br/></div><div>    public static final int WINDOW_STATUS_BAR = 1;</div><div>    public static final int WINDOW_NAVIGATION_BAR = 2;</div><div><br/></div><div>    public static final int WINDOW_STATE_SHOWING = 0;</div><div>    public static final int WINDOW_STATE_HIDING = 1;</div><div>    public static final int WINDOW_STATE_HIDDEN = 2;</div><div><br/></div><div>    private Context mContext;</div><div>    private IStatusBarService mService;</div><div>    private IBinder mToken = new Binder();</div><div><br/></div><div>    private static final String TAG = &quot;StatusBarManager&quot;;</div><div><br/></div><div>    StatusBarManager(Context context) {</div><div>        mContext = context;</div><div>    }</div><div><br/></div><div>    private synchronized IStatusBarService getService() {</div><div>        if (mService == null) {</div><div>            mService = IStatusBarService.Stub.asInterface(</div><div>                    ServiceManager.getService(Context.STATUS_BAR_SERVICE));</div><div>            if (mService == null) {</div><div>                Slog.w(&quot;StatusBarManager&quot;, &quot;warning: no STATUS_BAR_SERVICE&quot;);</div><div>            }</div><div>        }</div><div>        return mService;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Disable some features in the status bar.  Pass the bitwise-or of the DISABLE_* flags.</div><div>     * To re-enable everything, pass {@link #DISABLE_NONE}.</div><div>     */</div><div>    public void disable(int what) {</div><div>        try {</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.disable(what, mToken, mContext.getPackageName());</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            // system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Expand the notifications panel.</div><div>     */</div><div>    public void expandNotificationsPanel() {</div><div>        try {</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.expandNotificationsPanel();</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            // system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Collapse the notifications and settings panels.</div><div>     */</div><div>    public void collapsePanels() {</div><div>        try {</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.collapsePanels();</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            // system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Expand the settings panel.</div><div>     */</div><div>    public void expandSettingsPanel() {</div><div>        try {</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.expandSettingsPanel();</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            // system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    public void setIcon(String slot, int iconId, int iconLevel, String contentDescription) {</div><div>        try {</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.setIcon(slot, mContext.getPackageName(), iconId, iconLevel,</div><div>                    contentDescription);</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            // system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    public void removeIcon(String slot) {</div><div>        try {</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.removeIcon(slot);</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            // system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    public void setIconVisibility(String slot, boolean visible) {</div><div>        try {</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.setIconVisibility(slot, visible);</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            // system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    /** @hide */</div><div>    public static String windowStateToString(int state) {</div><div>        if (state == WINDOW_STATE_HIDING) return &quot;WINDOW_STATE_HIDING&quot;;</div><div>        if (state == WINDOW_STATE_HIDDEN) return &quot;WINDOW_STATE_HIDDEN&quot;;</div><div>        if (state == WINDOW_STATE_SHOWING) return &quot;WINDOW_STATE_SHOWING&quot;;</div><div>        return &quot;WINDOW_STATE_UNKNOWN&quot;;</div><div>    }</div><div><br/></div><div><br/></div><div>    /** M: Support &quot;SystemUI SIM indicator&quot; feature. @{ */</div><div><br/></div><div>    /**</div><div>      * M: showSimIndicator: shows default (current-selected) SIM indicator in StatusBar</div><div>      *    for a specific business type (e.g. Message, Call)</div><div>      *</div><div>      * @param componentName the package name which makes the call (it doesn't need to be the app who owns the business)</div><div>      * @param businessType  the type of the default SIM setting. ex. VOICE_CALL</div><div>      * @hide</div><div>      * @internal</div><div>      */</div><div>    public void showSimIndicator(ComponentName componentName, String businessType) {</div><div>        String pkgName = componentName == null ? &quot;null&quot; : componentName.getPackageName();</div><div>        try {</div><div>            Xlog.d(TAG, &quot;Show SIM indicator from &quot; + pkgName + &quot;, businiss is &quot; + businessType + &quot;.&quot;);</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                svc.showSimIndicator(businessType);</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            Xlog.d(TAG, &quot;Show SIM indicator from &quot; + pkgName + &quot; occurs exception.&quot;);</div><div>            /// M: system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>      * M: hideSimIndicator: hides default SIM indicator</div><div>      *</div><div>      * @param componentName the package name which makes the call</div><div>      * @hide</div><div>      * @internal</div><div>      */</div><div>    public void hideSimIndicator(ComponentName componentName) {</div><div>        String pkgName = componentName == null ? &quot;null&quot; : componentName.getPackageName();</div><div>        try {</div><div>            Xlog.d(TAG, &quot;Hide SIM indicator from &quot; + pkgName + &quot;.&quot;);</div><div>            final IStatusBarService svc = getService();</div><div>            if (svc != null) {</div><div>                mService.hideSimIndicator();</div><div>            }</div><div>        } catch (RemoteException ex) {</div><div>            Xlog.d(TAG, &quot;Hide SIM indicator from &quot; + pkgName + &quot; occurs exception.&quot;);</div><div>            /// M: system process is dead anyway.</div><div>            throw new RuntimeException(ex);</div><div>        }</div><div>    }</div><div><br/></div><div>    /** }@ */</div><div>}</div><div><br/></div></span>
</div></body></html> 