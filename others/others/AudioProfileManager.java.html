<html>
<head>
  <title>AudioProfileManager.java</title>
  <basefont face="Microsoft YaHei" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/301769 (zh-CN); Windows/6.3.9600 (Win64);"/>
  <style>
    body, td {
      font-family: Microsoft YaHei;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="988"/>
<h1>AudioProfileManager.java</h1>

<div>
<span><div>/* Copyright Statement:</div><div> *</div><div> * This software/firmware and related documentation (&quot;MediaTek Software&quot;) are</div><div> * protected under relevant copyright laws. The information contained herein</div><div> * is confidential and proprietary to MediaTek Inc. and/or its licensors.</div><div> * Without the prior written permission of MediaTek inc. and/or its licensors,</div><div> * any reproduction, modification, use or disclosure of MediaTek Software,</div><div> * and information contained herein, in whole or in part, shall be strictly prohibited.</div><div> *</div><div> * MediaTek Inc. (C) 2010. All rights reserved.</div><div> *</div><div> * BY OPENING THIS FILE, RECEIVER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES</div><div> * THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS (&quot;MEDIATEK SOFTWARE&quot;)</div><div> * RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO RECEIVER ON</div><div> * AN &quot;AS-IS&quot; BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,</div><div> * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF</div><div> * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.</div><div> * NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE</div><div> * SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR</div><div> * SUPPLIED WITH THE MEDIATEK SOFTWARE, AND RECEIVER AGREES TO LOOK ONLY TO SUCH</div><div> * THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. RECEIVER EXPRESSLY ACKNOWLEDGES</div><div> * THAT IT IS RECEIVER'S SOLE RESPONSIBILITY TO OBTAIN FROM ANY THIRD PARTY ALL PROPER LICENSES</div><div> * CONTAINED IN MEDIATEK SOFTWARE. MEDIATEK SHALL ALSO NOT BE RESPONSIBLE FOR ANY MEDIATEK</div><div> * SOFTWARE RELEASES MADE TO RECEIVER'S SPECIFICATION OR TO CONFORM TO A PARTICULAR</div><div> * STANDARD OR OPEN FORUM. RECEIVER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND</div><div> * CUMULATIVE LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,</div><div> * AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,</div><div> * OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY RECEIVER TO</div><div> * MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE.</div><div> *</div><div> * The following software/firmware and/or related documentation (&quot;MediaTek Software&quot;)</div><div> * have been modified by MediaTek Inc. All revisions are subject to any receiver's</div><div> * applicable license agreements with MediaTek Inc.</div><div> */</div><div><br/></div><div>package com.mediatek.audioprofile;</div><div><br/></div><div>import java.util.ArrayList;</div><div>import java.util.HashMap;</div><div>import java.util.List;</div><div>import java.util.Locale;</div><div><br/></div><div>import android.content.Context;</div><div>import android.media.AudioManager;</div><div>import android.media.RingtoneManager;</div><div>import android.net.Uri;</div><div>import android.os.IBinder;</div><div>import android.os.RemoteException;</div><div>import android.os.ServiceManager;</div><div>import android.os.UserHandle;</div><div>import android.provider.Settings;</div><div>import android.util.Log;</div><div><br/></div><div>import com.mediatek.common.audioprofile.AudioProfileListener;</div><div>import com.mediatek.common.audioprofile.IAudioProfileExtension.IDefaultProfileStatesGetter;</div><div>import com.mediatek.common.audioprofile.IAudioProfileManager;</div><div>import com.mediatek.common.audioprofile.IAudioProfileService;</div><div>import com.mediatek.common.audioprofile.IAudioProfileListener;</div><div>import com.mediatek.audioprofile.DefaultProfileStatesGetter;</div><div>import com.mediatek.common.MPlugin;</div><div><br/></div><div>/**</div><div> * AudioProfileManager provides access to audioprofile mode control.</div><div> * &lt;p&gt;</div><div> * Use &lt;code&gt;Context.getSystemService(Context.AUDIO_PROFILE_SERVICE)&lt;/code&gt; to get</div><div> * an instance of this class.</div><div> */</div><div>public class AudioProfileManager implements IAudioProfileManager {</div><div>    private static final String TAG = &quot;AudioProfileManager&quot;;</div><div>    private final Context mContext;</div><div>    private static IAudioProfileService sService;</div><div><br/></div><div>    /**</div><div>     * The max AudioProfile count.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int MAX_PROFILES_COUNT = 10;</div><div><br/></div><div>    /**</div><div>     * The predefined AudioProfile count.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int PREDEFINED_PROFILES_COUNT = 4;</div><div><br/></div><div>    /** The predefined max volume  outdoor. */</div><div>    public static final int DEFAULT_MAX_VOLUME_OUTDOOR = 15;</div><div><br/></div><div>    /**</div><div>     * The audio stream for the phone ring.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int STREAM_RING = AudioManager.STREAM_RING;</div><div><br/></div><div>    /**</div><div>     * The audio stream for notifications.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int STREAM_NOTIFICATION = AudioManager.STREAM_NOTIFICATION;</div><div><br/></div><div>    /**</div><div>     * The audio stream for alarm.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int STREAM_ALARM = AudioManager.STREAM_ALARM;</div><div><br/></div><div>    /**</div><div>     * Type that refers to sounds that are used for the phone ringer.</div><div>     *</div><div>     * @see #getRingtoneUri(Context, int)</div><div>     * @see #setRingtoneUri(Context, int, Uri)</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int TYPE_RINGTONE = RingtoneManager.TYPE_RINGTONE;</div><div><br/></div><div>    /**</div><div>     * Type that refers to sounds that are used for notifications.</div><div>     *</div><div>     * @see #getRingtoneUri(Context, int)</div><div>     * @see #setRingtoneUri(Context, int, Uri)</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int TYPE_NOTIFICATION = RingtoneManager.TYPE_NOTIFICATION;</div><div><br/></div><div>    /**</div><div>     * Type that refers to sounds that are used for the video call.</div><div>     *</div><div>     * @see #getRingtoneUri(Context, int)</div><div>     * @see #setRingtoneUri(Context, int, Uri)</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int TYPE_VIDEO_CALL = RingtoneManager.TYPE_VIDEO_CALL;</div><div><br/></div><div>    /**</div><div>     * Type that refers to sounds that are used for the sip call.</div><div>     *</div><div>     * @see #getRingtoneUri(Context, int)</div><div>     * @see #setRingtoneUri(Context, int, Uri)</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final int TYPE_SIP_CALL = RingtoneManager.TYPE_SIP_CALL;</div><div><br/></div><div>    /** Broadcast intent action indicating that the audio profile has changed. */</div><div>    public static final String ACTION_PROFILE_CHANGED = &quot;com.mediatek.audioprofile.ACTION_PROFILE_CHANGED&quot;;</div><div><br/></div><div>    /** The scenario type of new audio profile. */</div><div>    public static final String EXTRA_PROFILE_SCENARIO = &quot;com.mediatek.audioprofile.EXTRA_PROFILE_SCENARIO&quot;;</div><div><br/></div><div>    /**</div><div>     * The prefixe of audio profile keys.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final String PROFILE_PREFIX = &quot;mtk_audioprofile_&quot;;</div><div><br/></div><div>    /** The suffixes of the settings' keys. */</div><div>    private static final String SUFFIX_RINGER_URI = &quot;_ringtone&quot;;</div><div>    private static final String SUFFIX_NOTIFICATION_URI = &quot;_notification_sound&quot;;</div><div>    //M {</div><div>    private static final String SUFFIX_VIDEO_CALL_URI = &quot;_video_call&quot;;</div><div>    private static final String SUFFIX_SIP_CALL_URI = &quot;_sip_call&quot;;</div><div>    //}</div><div>    private static final String SUFFIX_RINGER_VOLUME = &quot;_volume_ring&quot;;</div><div>    private static final String SUFFIX_ALARM_VOLUME = &quot;_volume_alarm&quot;;</div><div>    private static final String SUFFIX_NOTIFICATION_VOLUME = &quot;_volume_notification&quot;;</div><div>    private static final String SUFFIX_VIBRATION = &quot;_vibrate_on&quot;;</div><div>    private static final String SUFFIX_SOUNDEFFECT = &quot;_sound_effects_enabled&quot;;</div><div>    private static final String SUFFIX_DTMFTONE = &quot;_dtmf_tone_enabled&quot;;</div><div>    private static final String SUFFIX_HAPTICFEEDBACK = &quot;_haptic_feedback_enabled&quot;;</div><div>    private static final String SUFFIX_LOCK_SCRREN = &quot;_lockscreen_sounds_enabled&quot;;</div><div>    private static final String SUFFIX_NOTIFICATION_USE_RING = &quot;_notifications_use_ring_volume&quot;;</div><div>    public static final String SUFFIX_NAME = &quot;_name&quot;;</div><div>    public static final String SUFFIX_KEY = &quot;_key&quot;;</div><div>    public static final String SUFFIX_DATA = &quot;_data&quot;;</div><div>    public static final String SUFFIX_SIM_ID = &quot;_sim_id&quot;;</div><div><br/></div><div>    /**</div><div>     * The key used to store the active audio profile.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final String KEY_ACTIVE_PROFILE = &quot;mtk_audioprofile_active&quot;;</div><div><br/></div><div>    /** The key used to store the previous active audio profile. */</div><div>    public static final String LAST_ACTIVE_PROFILE = &quot;mtk_audioprofile_last_active&quot;;</div><div><br/></div><div>    /** The key used to store whether one custom audio profile was deleted when it was set active.*/</div><div>    public static final String LAST_ACTIVE_CUSTOM_DELETED = &quot;mtk_audioprofile_custom_deleted&quot;;</div><div><br/></div><div>    /**</div><div>     * The key used to store the default ringtone of voice call.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final String KEY_DEFAULT_RINGTONE = &quot;mtk_audioprofile_default_ringtone&quot;;</div><div><br/></div><div>    /**</div><div>     * The key used to store the default notification sound.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final String KEY_DEFAULT_NOTIFICATION = &quot;mtk_audioprofile_default_notification&quot;;</div><div><br/></div><div>    /**</div><div>     * The key used to store the default ringtone of video call.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public static final String KEY_DEFAULT_VIDEO_CALL = &quot;mtk_audioprofile_default_video_call&quot;;</div><div><br/></div><div>    /** The key used to store the default ringtone of sip call. */</div><div>    public static final String KEY_DEFAULT_SIP_CALL = &quot;mtk_audioprofile_default_sip_call&quot;;</div><div><br/></div><div>    /** The key used to store the bessuround state. */</div><div>    public static final String KEY_BESSUROUND_STATE = &quot;mtk_audioprofile_bessuround&quot;;</div><div><br/></div><div>    /** The key used to store the bessuround mode. */</div><div>    public static final String KEY_BESSUROUND_MODE = &quot;mtk_audioprofile_bessuround_mode&quot;;</div><div><br/></div><div>    /** Volume returned when unSupported stream type was passed in. */</div><div>    public static final int UNSUPPORT_STREAM_VOLUME = 0;</div><div><br/></div><div>    /** Default ringtone for normal calls. */</div><div>    public static final Uri DEFAULT_RINGER_STREAM_URI = Settings.System.DEFAULT_RINGTONE_URI;</div><div><br/></div><div>    /** Default ringtone for notification. */</div><div>    public static final Uri DEFAULT_NOTIFICATION_STREAM_URI = Settings.System.DEFAULT_NOTIFICATION_URI;</div><div><br/></div><div>    /** Default ringtone for video calls. */</div><div>    public static final Uri DEFAULT_VIDEO_STREAM_URI = Settings.System.DEFAULT_VIDEO_CALL_URI;</div><div><br/></div><div>    /** Default ringtone for sip calls. */</div><div>    public static final Uri DEFAULT_SIP_STREAM_URI = Settings.System.DEFAULT_SIP_CALL_URI;</div><div><br/></div><div>    // Default AudioProfile states</div><div>    private static HashMap&lt;Integer, AudioProfileState&gt; sDEFAULTSTATES = null;</div><div><br/></div><div>    public static final int KEY_SURROUND_OFF = 0;</div><div>    public static final int KEY_SURROUND_ON = 1;</div><div>    public static final int KEY_MOVIE_MODE_CODE = 0;</div><div>    public static final int KEY_MUSIC_MODE_CODE = 1;</div><div><br/></div><div>    /**</div><div>     * The profile settings that an audio profile should have.</div><div>     */</div><div>    public enum ProfileSettings {</div><div>        ringer_stream, notification_stream, videocall_Stream, sipcall_Stream,</div><div>        ringer_volume, notification_volume, alarm_volume,</div><div>        vibration_enabled, dtmftone_enabled, soundeffect_enbled, hapticfeedback_enabled,</div><div>        lockscreensound_enabled</div><div>    }</div><div><br/></div><div>    /**</div><div>     * The scenario that an audio profile is designed for.</div><div>     */</div><div>    public enum Scenario {</div><div>        /** @internal */ GENERAL, </div><div>        /** @internal */ SILENT, </div><div>        /** @internal */ MEETING, </div><div>        /** @internal */ OUTDOOR, </div><div>        /** @internal */ CUSTOM</div><div>    }</div><div><br/></div><div>    // M: fixed ALPS01270292</div><div>    private static final String[] REAL_PROFILE_KEY = {&quot;general&quot;, &quot;meeting&quot;, &quot;silent&quot;, &quot;outdoor&quot;, &quot;custom&quot;};</div><div><br/></div><div>    private static IDefaultProfileStatesGetter mDefaultProfileStatesGetter;</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Construction and get AudioProfileSevices</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    /**</div><div>     * AudioProfile constructor</div><div>     *</div><div>     * @param context Context</div><div>     * @hide</div><div>     */</div><div>    public AudioProfileManager(Context context) {</div><div>        mContext = context;</div><div>        mDefaultProfileStatesGetter = </div><div>            MPlugin.createInstance(IDefaultProfileStatesGetter.class.getName(), mContext);</div><div>        if (mDefaultProfileStatesGetter == null) {</div><div>            mDefaultProfileStatesGetter = new DefaultProfileStatesGetter();</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Get AudioProfile service</div><div>     *</div><div>     * @return AudioProfile service</div><div>     */</div><div>    private static IAudioProfileService getService() {</div><div>        if (sService != null) {</div><div>            try {</div><div>                sService.setUserId(UserHandle.myUserId());</div><div>            } catch (RemoteException e) {</div><div>                Log.e(TAG, &quot;Set user id exception&quot;, e);</div><div>            }</div><div>            return sService;</div><div>        }</div><div>        IBinder binder = ServiceManager.getService(Context.AUDIO_PROFILE_SERVICE);</div><div>        sService = IAudioProfileService.Stub.asInterface(binder);</div><div>        try {</div><div>            sService.setUserId(UserHandle.myUserId());</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Set user id exception&quot;, e);</div><div>        }</div><div>        return sService;</div><div>    }</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Get default state method</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div><br/></div><div>    /**</div><div>     * Gets the default settings .</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile which's default settings to be</div><div>     *            retrieved.</div><div>     * @return The corresponding default settings of profiles except that</div><div>     *         it returns the GENERAL profile's default setting when scenario is CUSTOM.</div><div>     */</div><div>    public static AudioProfileState getDefaultState(String profileKey) {</div><div>        if (null == sDEFAULTSTATES) {</div><div>            if (mDefaultProfileStatesGetter != null) {</div><div>                sDEFAULTSTATES = mDefaultProfileStatesGetter.getDefaultProfileStates();</div><div>            }</div><div>            if (null == sDEFAULTSTATES) {</div><div>                sDEFAULTSTATES = new HashMap&lt;Integer, AudioProfileState&gt;(PREDEFINED_PROFILES_COUNT);</div><div>                /** Default values of ringer volume for different audio profiles. */</div><div>                final int DEFAULT_RINGER_VOLUME_GENERAL = 5;</div><div>                final int DEFAULT_RINGER_VOLUME_SILENT = 0;</div><div>                final int DEFAULT_RINGER_VOLUME_MEETING = 0;</div><div>                final int DEFAULT_RINGER_VOLUME_OUTDOOR = 5;</div><div><br/></div><div>                /** Default values of notification volume for different audio profiles. */</div><div>                final int DEFAULT_NOTIFICATION_VOLUME_GENERAL = 5;</div><div>                final int DEFAULT_NOTIFICATION_VOLUME_SILENT = 0;</div><div>                final int DEFAULT_NOTIFICATION_VOLUME_MEETING = 0;</div><div>                final int DEFAULT_NOTIFICATION_VOLUME_OUTDOOR = 5;</div><div><br/></div><div>                /** Default values of alarm volume for different audio profiles. */</div><div>                final int DEFAULT_ALARM_VOLUME_GENERAL = 5;</div><div>                final int DEFAULT_ALARM_VOLUME_SILENT = 0;</div><div>                final int DEFAULT_ALARM_VOLUME_MEETING = 0;</div><div>                final int DEFAULT_ALARM_VOLUME_OUTDOOR = 5;</div><div><br/></div><div>                /** Default values of vibration for different audio profiles. */</div><div>                final boolean DEFAULT_VIBRATION_GENERAL = false;</div><div>                final boolean DEFAULT_VIBRATION_SILENT = false;</div><div>                final boolean DEFAULT_VIBRATION_MEETING = true;</div><div>                final boolean DEFAULT_VIBRATION_OUTDOOR = true;</div><div><br/></div><div>                /**</div><div>                 * Default values that indicate whether the audible DTMF tone should be</div><div>                 * played by the dialer when dialing.</div><div>                 */</div><div>                final boolean DEFAULT_DTMFTONE_GENERAL = true;</div><div>                final boolean DEFAULT_DTMFTONE_SILENT = false;</div><div>                final boolean DEFAULT_DTMFTONE_MEETING = false;</div><div>                final boolean DEFAULT_DTMFTONE_OUTDOOR = true;</div><div><br/></div><div>                /**</div><div>                 * Default values of sound effect(Key clicks, lid open/close...) for</div><div>                 * different audio profiles.</div><div>                 */</div><div>                final boolean DEFAULT_SOUNDEFFECT_GENERAL = false;</div><div>                final boolean DEFAULT_SOUNDEFFECT_SILENT = false;</div><div>                final boolean DEFAULT_SOUNDEFFECT_MEETING = false;</div><div>                final boolean DEFAULT_SOUNDEFFECT_OUTDOOR = false;</div><div><br/></div><div>                /** Default values that indicate whether the lock screen sound are enabled. */</div><div>                final boolean DEFAULT_LOCK_SCREEN_GENERAL = true;</div><div>                final boolean DEFAULT_LOCK_SCREEN_SILENT = false;</div><div>                final boolean DEFAULT_LOCK_SCREEN_MEETING = false;</div><div>                final boolean DEFAULT_LOCK_SCREEN_OUTDOOR = true;</div><div><br/></div><div>                /** Default values that indicate whether the haptic feedback are enabled. */</div><div>                final boolean DEFAULT_HAPTIC_FEEDBACK_GENERAL = true;</div><div>                final boolean DEFAULT_HAPTIC_FEEDBACK_SILENT = false;</div><div>                final boolean DEFAULT_HAPTIC_FEEDBACK_MEETING = false;</div><div>                final boolean DEFAULT_HAPTIC_FEEDBACK_OUTDOOR = true;</div><div><br/></div><div>                // Init general state and push it to DEFAULTSTATES</div><div>                AudioProfileState generalState = new AudioProfileState.Builder(getProfileKey(Scenario.GENERAL))</div><div>                    .ringtone(DEFAULT_RINGER_STREAM_URI, DEFAULT_NOTIFICATION_STREAM_URI, DEFAULT_VIDEO_STREAM_URI)</div><div>                    .volume(DEFAULT_RINGER_VOLUME_GENERAL, DEFAULT_NOTIFICATION_VOLUME_GENERAL,</div><div>                            DEFAULT_ALARM_VOLUME_GENERAL)</div><div>                    .vibration(DEFAULT_VIBRATION_GENERAL)</div><div>                    .dtmfTone(DEFAULT_DTMFTONE_GENERAL)</div><div>                    .soundEffect(DEFAULT_SOUNDEFFECT_GENERAL)</div><div>                    .lockScreenSound(DEFAULT_LOCK_SCREEN_GENERAL)</div><div>                    .hapticFeedback(DEFAULT_HAPTIC_FEEDBACK_GENERAL)</div><div>                    .build();</div><div>                sDEFAULTSTATES.put(Scenario.GENERAL.ordinal(), generalState);</div><div><br/></div><div>                // Init silent state and push it to DEFAULTSTATES</div><div>                AudioProfileState silentState = new AudioProfileState.Builder(getProfileKey(Scenario.SILENT))</div><div>                    .ringtone(DEFAULT_RINGER_STREAM_URI, DEFAULT_NOTIFICATION_STREAM_URI, DEFAULT_VIDEO_STREAM_URI)</div><div>                    .volume(DEFAULT_RINGER_VOLUME_SILENT, DEFAULT_NOTIFICATION_VOLUME_SILENT,</div><div>                            DEFAULT_ALARM_VOLUME_SILENT)</div><div>                    .vibration(DEFAULT_VIBRATION_SILENT)</div><div>                    .dtmfTone(DEFAULT_DTMFTONE_SILENT)</div><div>                    .soundEffect(DEFAULT_SOUNDEFFECT_SILENT)</div><div>                    .lockScreenSound(DEFAULT_LOCK_SCREEN_SILENT)</div><div>                    .hapticFeedback(DEFAULT_HAPTIC_FEEDBACK_SILENT)</div><div>                    .build();</div><div>                sDEFAULTSTATES.put(Scenario.SILENT.ordinal(), silentState);</div><div><br/></div><div>                // Init meeting state and push it to DEFAULTSTATES</div><div>                AudioProfileState meetingState = new AudioProfileState.Builder(getProfileKey(Scenario.MEETING))</div><div>                    .ringtone(DEFAULT_RINGER_STREAM_URI, DEFAULT_NOTIFICATION_STREAM_URI, DEFAULT_VIDEO_STREAM_URI)</div><div>                    .volume(DEFAULT_RINGER_VOLUME_MEETING, DEFAULT_NOTIFICATION_VOLUME_MEETING,</div><div>                            DEFAULT_ALARM_VOLUME_MEETING)</div><div>                    .vibration(DEFAULT_VIBRATION_MEETING)</div><div>                    .dtmfTone(DEFAULT_DTMFTONE_MEETING)</div><div>                    .soundEffect(DEFAULT_SOUNDEFFECT_MEETING)</div><div>                    .lockScreenSound(DEFAULT_LOCK_SCREEN_MEETING)</div><div>                    .hapticFeedback(DEFAULT_HAPTIC_FEEDBACK_MEETING)</div><div>                    .build();</div><div>                sDEFAULTSTATES.put(Scenario.MEETING.ordinal(), meetingState);</div><div><br/></div><div>                // Init outdoor state and push it to DEFAULTSTATES</div><div>                AudioProfileState outdoorState = new AudioProfileState.Builder(getProfileKey(Scenario.OUTDOOR))</div><div>                    .ringtone(DEFAULT_RINGER_STREAM_URI, DEFAULT_NOTIFICATION_STREAM_URI, DEFAULT_VIDEO_STREAM_URI)</div><div>                    .volume(DEFAULT_RINGER_VOLUME_OUTDOOR, DEFAULT_NOTIFICATION_VOLUME_OUTDOOR,</div><div>                            DEFAULT_ALARM_VOLUME_OUTDOOR)</div><div>                    .vibration(DEFAULT_VIBRATION_OUTDOOR)</div><div>                    .dtmfTone(DEFAULT_DTMFTONE_OUTDOOR)</div><div>                    .soundEffect(DEFAULT_SOUNDEFFECT_OUTDOOR)</div><div>                    .lockScreenSound(DEFAULT_LOCK_SCREEN_OUTDOOR)</div><div>                    .hapticFeedback(DEFAULT_HAPTIC_FEEDBACK_OUTDOOR)</div><div>                    .build();</div><div>                sDEFAULTSTATES.put(Scenario.OUTDOOR.ordinal(), outdoorState);</div><div>                Log.d(TAG, &quot;getDefaultState from default!&quot;);</div><div>            }</div><div>        }</div><div><br/></div><div>        Scenario scenario = getScenario(profileKey);</div><div>        if (scenario == null) {</div><div>            Log.w(TAG, &quot;getDefaultState: get null scenario and use custom scenario default!&quot;);</div><div>            scenario = Scenario.CUSTOM;</div><div>        }</div><div>        int index = scenario.ordinal();</div><div>        if (index &gt;= sDEFAULTSTATES.size()) {</div><div>            return sDEFAULTSTATES.get(0);</div><div>        } else {</div><div>            return sDEFAULTSTATES.get(index);</div><div>        }</div><div>    }</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Get key methods</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting setting that indicates whether phone should vibrate for incoming</div><div>     * calls.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @return The key for persisting setting.</div><div>     * @internal</div><div>     */</div><div>    public static String getVibrationKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_VIBRATION;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting setting that indicates whether sound should be played when making</div><div>     * screen selection.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @return The key for persisting setting.</div><div>     *</div><div>     */</div><div>    public static String getSoundEffectKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_SOUNDEFFECT;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting setting that indicates whether sound should be played when using</div><div>     * dial pad.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @return The key for persisting setting.</div><div>     */</div><div>    public static String getDtmfToneKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_DTMFTONE;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting the setting that indicates whether the phone should vibrate when</div><div>     * pressing soft keys and on certain UI interactions.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile..</div><div>     * @return The key for persisting setting.</div><div>     */</div><div>    public static String getHapticKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_HAPTICFEEDBACK;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting volume.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @param type</div><div>     *            The stream type whose volume index to be persisted. One of</div><div>     *            {@link AudioProfile#STREAM_RING}, {@link AudioProfile#STREAM_NOTIFICATION}, or</div><div>     *            {@link AudioProfile#STREAM_ALARM}.</div><div>     * @return The key for persisting setting.</div><div>     */</div><div>    public static String getStreamVolumeKey(String profileKey, int type) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;getStreamVolumeKey with null profile key!&quot;);</div><div>            return null;</div><div>        }</div><div><br/></div><div>        String volumeKey = null;</div><div>        switch (type) {</div><div>            case STREAM_RING:</div><div>                volumeKey = profileKey + SUFFIX_RINGER_VOLUME;</div><div>                break;</div><div><br/></div><div>            case STREAM_NOTIFICATION:</div><div>                volumeKey = profileKey + SUFFIX_NOTIFICATION_VOLUME;</div><div>                break;</div><div><br/></div><div>            case STREAM_ALARM:</div><div>                volumeKey = profileKey + SUFFIX_ALARM_VOLUME;</div><div>                break;</div><div><br/></div><div>            default:</div><div>                Log.e(TAG, &quot;getStreamVolumeKey with unsupport type!&quot;);</div><div>        }</div><div>        return volumeKey;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting stream volume.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @param type</div><div>     *            The type whose default sound to be persisted. One of</div><div>     *            {@link AudioProfile#TYPE_RINGTONE}, {@link AudioProfile#TYPE_NOTIFICATION}, or</div><div>     *            {@link AudioProfile#TYPE_VOICE_CALL}.</div><div>     * @return The key for persisting setting.</div><div>     */</div><div>    public static String getStreamUriKey(String profileKey, int type) {</div><div>        long simId = -1 ;</div><div>        return getStreamUriKey(profileKey, type, simId);</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting stream volume.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @param type</div><div>     *            The type whose default sound to be persisted. One of</div><div>     *            {@link AudioProfile#TYPE_RINGTONE}, {@link AudioProfile#TYPE_NOTIFICATION}, or</div><div>     *            {@link AudioProfile#TYPE_VOICE_CALL}.</div><div>     * @return The key for persisting setting.</div><div>     */</div><div>    public static String getStreamUriKey(String profileKey, int type, long simId) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;getStreamUriKey with null profile key!&quot;);</div><div>            return null;</div><div>        }</div><div><br/></div><div>        String uriKey = null;</div><div>        switch (type) {</div><div>            case TYPE_RINGTONE:</div><div>                uriKey = profileKey + SUFFIX_RINGER_URI;</div><div>                // M add for sim difference ringtone {</div><div>                if (simId != -1) {</div><div>                    uriKey = uriKey + SUFFIX_SIM_ID + simId;</div><div>                }</div><div><br/></div><div>                //}</div><div>                break;</div><div><br/></div><div>            case TYPE_NOTIFICATION:</div><div>                uriKey = profileKey + SUFFIX_NOTIFICATION_URI;</div><div>                break;</div><div><br/></div><div>            case TYPE_VIDEO_CALL:</div><div>                uriKey = profileKey + SUFFIX_VIDEO_CALL_URI;</div><div>                //uriKey = profileKey + SUFFIX_RINGER_URI;</div><div>                // M add for sim difference ringtone {</div><div>                if (simId != -1) {</div><div>                    uriKey = uriKey + SUFFIX_SIM_ID + simId;</div><div>                }</div><div><br/></div><div>                //}</div><div>                break;</div><div><br/></div><div>            case TYPE_SIP_CALL:</div><div>                uriKey = profileKey + SUFFIX_SIP_CALL_URI;</div><div>                //uriKey = profileKey + SUFFIX_RINGER_URI;</div><div>                // M add for sim difference ringtone {</div><div>                if (simId != -1) {</div><div>                    uriKey = uriKey + SUFFIX_SIM_ID + simId;</div><div>                }</div><div><br/></div><div>                //}</div><div>                break;</div><div>            default:</div><div>                Log.e(TAG, &quot;getStreamUriKey with unsupport type!&quot;);</div><div>        }</div><div>        Log.d(TAG, &quot;getStreamUriKey: StreamUriKey = &quot; + uriKey);</div><div>        return uriKey;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the keys to save the default ringtone for predefined scenarios except for silent.</div><div>     *</div><div>     * @param type</div><div>     *            Stream type. One of {@link AudioProfile#TYPE_RINGTONE},</div><div>     *            {@link AudioProfile#TYPE_NOTIFICATION}, or {@link AudioProfile#TYPE_VOICE_CALL}.</div><div>     * @return The stream uri key of given type</div><div>     */</div><div>    public static List&lt;String&gt; getStreamUriKeys(int type) {</div><div>        List&lt;String&gt; keys = new ArrayList&lt;String&gt;();</div><div>        for (Scenario scenario : Scenario.values()) {</div><div>            if (!Scenario.SILENT.equals(scenario) &amp;&amp; !Scenario.CUSTOM.equals(scenario)) {</div><div>                String prefix = PROFILE_PREFIX + coverToProfileKey(scenario);</div><div>                String key = getStreamUriKey(prefix, type);</div><div>                if (key != null) {</div><div>                    keys.add(key);</div><div>                }</div><div>            }</div><div>        }</div><div>        return keys;</div><div>    }</div><div><br/></div><div>    public static String getDataKey(String uriKey) {</div><div>        if (uriKey != null) {</div><div>            return uriKey + SUFFIX_DATA;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting the setting that indicates whether sounds should be played when</div><div>     * the keyguard is shown and dismissed.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @return The key for persisting setting.</div><div>     */</div><div>    public static String getLockScreenKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_LOCK_SCRREN;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting the setting that indicates whether notification use ring volume.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @return The key for persisting setting.</div><div>     */</div><div>    public static String getNotificationUseRingKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_NOTIFICATION_USE_RING;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting the profile's name.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @return The key for persisting profile's name.</div><div>     */</div><div>    public static String getProfileNameKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_NAME;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key for persisting the profile's key.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile.</div><div>     * @return The key of given profile key</div><div>     */</div><div>    public static String getKey(String profileKey) {</div><div>        if (profileKey != null) {</div><div>            return profileKey + SUFFIX_KEY;</div><div>        }</div><div>        return null;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the profile's key from scenario type.</div><div>     *</div><div>     * @param scenario</div><div>     *            The scenario type.</div><div>     * @return The scenario's profile key. If scenario is one of four predefine types of scenario,</div><div>     *         the profile key can be used immediately, is it is custom one, the profile key should</div><div>     *         be add more information to mark off custom profiles.</div><div>     * @internal</div><div>     */</div><div>    public static String getProfileKey(Scenario scenario) {</div><div>        if (scenario != null) {</div><div>            return PROFILE_PREFIX + coverToProfileKey(scenario);</div><div>        }</div><div>        Log.e(TAG, &quot;getProfileKey with null scenario!&quot;);</div><div>        return null;</div><div>    }</div><div><br/></div><div>    // M: fixed ALPS01270292</div><div>    private static String coverToProfileKey(Scenario scenario) {</div><div>        String realProfileKey = null;</div><div>        if (scenario.equals(scenario.GENERAL)) {</div><div>            realProfileKey = REAL_PROFILE_KEY[0];</div><div>        } else if (scenario.equals(scenario.MEETING)) {</div><div>            realProfileKey = REAL_PROFILE_KEY[1];</div><div>        } else if (scenario.equals(scenario.SILENT)) {</div><div>            realProfileKey = REAL_PROFILE_KEY[2];</div><div>        } else if (scenario.equals(scenario.OUTDOOR)) {</div><div>            realProfileKey = REAL_PROFILE_KEY[3];</div><div>        } else if (scenario.equals(scenario.CUSTOM)) {</div><div>            realProfileKey = REAL_PROFILE_KEY[4];</div><div>        }</div><div>        return realProfileKey;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the scenario type from profile's key.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The profile's key.</div><div>     * @return The scenario type of this profile. If the key doesn't contains the scenario, returns</div><div>     *         {@link Scenario#CUSTOM}.</div><div>     * @internal</div><div>     */</div><div>    public static Scenario getScenario(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.w(TAG, &quot;getScenario: Null key! Return CUSTOM as default!&quot;);</div><div>            return Scenario.CUSTOM;</div><div>        }</div><div><br/></div><div>        int keyLen = profileKey.length();</div><div>        int startIndex = PROFILE_PREFIX.length();</div><div>        if (keyLen &lt; startIndex) {</div><div>            Log.w(TAG, &quot;getScenario: Invalid key :&quot; + profileKey + &quot;, Return CUSTOM as default!&quot;);</div><div>            return Scenario.CUSTOM;</div><div>        }</div><div><br/></div><div>        int endIndex = profileKey.indexOf('_', startIndex);</div><div><br/></div><div>        String scenarioStr = profileKey.substring(startIndex, endIndex == -1 ? profileKey.length() : endIndex);</div><div>        try {</div><div>            return Scenario.valueOf(scenarioStr.toUpperCase(Locale.ENGLISH));</div><div>        } catch (IllegalArgumentException e) {</div><div>            Log.e(TAG, &quot;Can not convert string &quot; + scenarioStr + &quot; to Scenario type!&quot;);</div><div>            return Scenario.CUSTOM;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets all the keys used to store the settings of one audio profile.</div><div>     *</div><div>     * @param profileKey</div><div>     *            Audio profile key.</div><div>     * @return All keys of given profile</div><div>     */</div><div>    public static List&lt;String&gt; getAllKeys(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;getAllKeys: Null profileKey!&quot;);</div><div>            return null;</div><div>        }</div><div><br/></div><div>        final int keySize = 14; // avoid magic number</div><div>        List&lt;String&gt; keys = new ArrayList&lt;String&gt;(keySize);</div><div>        keys.add(getKey(profileKey));</div><div>        keys.add(getProfileNameKey(profileKey));</div><div>        keys.add(getNotificationUseRingKey(profileKey));</div><div>        keys.add(getLockScreenKey(profileKey));</div><div>        keys.add(getHapticKey(profileKey));</div><div>        keys.add(getDtmfToneKey(profileKey));</div><div>        keys.add(getSoundEffectKey(profileKey));</div><div>        keys.add(getVibrationKey(profileKey));</div><div>        keys.add(getStreamVolumeKey(profileKey, STREAM_ALARM));</div><div>        keys.add(getStreamVolumeKey(profileKey, STREAM_NOTIFICATION));</div><div>        keys.add(getStreamVolumeKey(profileKey, STREAM_RING));</div><div>        keys.add(getStreamUriKey(profileKey, TYPE_NOTIFICATION));</div><div>        keys.add(getStreamUriKey(profileKey, TYPE_RINGTONE));</div><div>        keys.add(getStreamUriKey(profileKey, TYPE_VIDEO_CALL));</div><div>        return keys;</div><div>    }</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Set active profile, add profile, delete profile and reset profiles</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div><br/></div><div>    /**</div><div>     * Sets the active profile with given profile key.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile that set to be active.</div><div>     * @internal</div><div>     */</div><div>    public void setActiveProfile(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setActiveProfile with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        Log.d(TAG, &quot;setActiveProfile: profileKey = &quot; + profileKey);</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setActiveProfile(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setActiveProfile&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Adds a new {@link Scenario#CUSTOM} type profile.</div><div>     *</div><div>     * @return The new profile key.</div><div>     * @internal</div><div>     */</div><div>    public String addProfile() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.addProfile();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setActiveProfile&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Deletes a {@link Scenario#CUSTOM} type profile.</div><div>     *</div><div>     * @param profileKey</div><div>     *            The key of the profile that to be deleted.</div><div>     * @return True if delete succeed, otherwise false.</div><div>     * @internal</div><div>     */</div><div>    public boolean deleteProfile(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;deleteProfile with null profile key!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.deleteProfile(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in deleteProfile&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Reset all profiles.</div><div>     *</div><div>     * @internal</div><div>     */</div><div>    public void resetProfiles() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.reset();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in resetProfile&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the number of current existing profiles. Include the predefined and custom ones.</div><div>     *</div><div>     * @return The number of existing profiles.</div><div>     * @internal</div><div>     */</div><div>    public int getProfileCount() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getProfileCount();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in deleteProfile&quot;, e);</div><div>            return MAX_PROFILES_COUNT;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the all existed profiles' keys.</div><div>     *</div><div>     * @return The existed profiles' keys.</div><div>     * @internal</div><div>     */</div><div>    public List&lt;String&gt; getAllProfileKeys() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getAllProfileKeys();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getAllProfileKeys&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets predefined profiles' keys.</div><div>     *</div><div>     * @return The predefined profiles' keys.</div><div>     * @internal</div><div>     */</div><div>    public List&lt;String&gt; getPredefinedProfileKeys() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getPredefinedProfileKeys();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getPredefinedProfileKeys&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets customized profiles' keys.</div><div>     *</div><div>     * @return The customized profiles' keys.</div><div>     */</div><div>    public List&lt;String&gt; getCustomizedProfileKeys() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getCustomizedProfileKeys();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getCustomizedProfileKeys&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Checks out whether the name existed.</div><div>     *</div><div>     * @param name</div><div>     *            The name to be checked.</div><div>     * @return True if the specified name had existed or if the name is null or empty, false</div><div>     *         otherwise.</div><div>     * @internal</div><div>     */</div><div>    public boolean isNameExist(String name) {</div><div>        if ((name == null) || (name.equals(&quot;&quot;))) {</div><div>            Log.w(TAG, &quot;isNameExist: Null or empty name!&quot;);</div><div>            return true;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isNameExist(name);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isNameExist&quot;, e);</div><div>            return true;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key of active profile.</div><div>     *</div><div>     * @return The key of the active profile.</div><div>     * @internal</div><div>     */</div><div>    public String getActiveProfileKey() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getActiveProfileKey();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getActiveProfileKey&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the key of previous non-silent active profile.</div><div>     *</div><div>     * @return The key of last non-silent active profile.</div><div>     */</div><div>    public String getLastActiveProfileKey() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getLastActiveProfileKey();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getLastActiveProfileKey&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Get methods to get profile settings with given profile key from persisted profile states</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div><br/></div><div>    /**</div><div>     * Gets the {@link Uri} of the default sound for a given ring tone type.</div><div>     *</div><div>     * @param profileKey The profile key ringtone uri is returned.</div><div>     * @param type The type whose default sound should be set. One of</div><div>     *            {@link #TYPE_RINGTONE}, {@link #TYPE_NOTIFICATION}</div><div>     *            or {@link #TYPE_VIDEO_CALL}.</div><div>     * @return A {@link Uri} pointing to the default sound to set.</div><div>     * @see #setRingtoneUri(Context, int, Uri)</div><div>     * @internal</div><div>     */</div><div>    public Uri getRingtoneUri(String profileKey, int type, long simId) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;getRingtoneUri with null profile key!&quot;);</div><div>            return null;</div><div>        }</div><div><br/></div><div>        if ((type == TYPE_RINGTONE) || (type == TYPE_NOTIFICATION) || (type == TYPE_VIDEO_CALL) || (type == TYPE_SIP_CALL)) {</div><div>            IAudioProfileService service = getService();</div><div>            try {</div><div>                return service.getRingtoneUriWithSIM(profileKey, type, simId);</div><div>            } catch (RemoteException e) {</div><div>                Log.e(TAG, &quot;Dead object in getRingtoneUri&quot;, e);</div><div>                return null;</div><div>            }</div><div>        } else {</div><div>            Log.e(TAG, &quot;getRingtoneUri with unsupport stream type!&quot;);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the {@link Uri} of the default sound for a given ring tone type.</div><div>     *</div><div>     * @param profileKey The profile key ringtone uri is returned.</div><div>     * @param type The type whose default sound should be set. One of</div><div>     *            {@link #TYPE_RINGTONE}, {@link #TYPE_NOTIFICATION}</div><div>     *            or {@link #TYPE_VIDEO_CALL}.</div><div>     * @return A {@link Uri} pointing to the default sound to set.</div><div>     * @see #setRingtoneUri(Context, int, Uri)</div><div>     * @internal</div><div>     */</div><div>    public Uri getRingtoneUri(String profileKey, int type) {</div><div>        long simId = -1;</div><div>        return getRingtoneUri(profileKey, type, simId);</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the {@link Uri} of the default sound for a given ring tone type.</div><div>     *</div><div>     * @param profileKey The profile key ringtone uri is returned.</div><div>     * @param type The type whose default sound should be set. One of</div><div>     *            {@link #TYPE_RINGTONE}, {@link #TYPE_NOTIFICATION}</div><div>     *            or {@link #TYPE_VIDEO_CALL}.</div><div>     * @return A {@link Uri} pointing to the default sound to set.</div><div>     * @see #setRingtoneUri(Context, int, Uri)</div><div>     */</div><div>    public Uri getRingtoneUri(int simId) {</div><div>        String profileKey = getActiveProfileKey();</div><div>        int type = TYPE_RINGTONE ;</div><div>        return getRingtoneUri(profileKey, type, simId);</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Get ringtone URI</div><div>     *</div><div>     * @param callType VOICE_CALL ,VIDEO_CALL, SIP_CALL</div><div>     * @param simId  SIM id</div><div>     *</div><div>     * @return</div><div>     */</div><div>    public Uri getRingtoneUri(int callType, long simId) {</div><div>        String profileKey = getActiveProfileKey();</div><div>        return getRingtoneUri(profileKey, callType, simId);</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Returns the current volume index for a particular stream.</div><div>     * @param profileKey The profile key whose volume index is returned.</div><div>     * @param streamType The stream type whose volume index is returned.</div><div>     *                   One of {@link #STREAM_RING}, {@link #STREAM_NOTIFICATION}</div><div>     *                   or {@link #STREAM_ALARM}.</div><div>     *</div><div>     * @return The current volume index for the stream.</div><div>     * @see #getStreamMaxVolume(int)</div><div>     * @see #setStreamVolume(int, int, int)</div><div>     * @internal</div><div>     */</div><div>    public int getStreamVolume(String profileKey, int streamType) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;getStreamVolume with null profile key!&quot;);</div><div>            return UNSUPPORT_STREAM_VOLUME;</div><div>        }</div><div><br/></div><div>        if ((streamType == STREAM_RING) || (streamType == STREAM_NOTIFICATION)</div><div>                || (streamType == STREAM_ALARM)) {</div><div>            IAudioProfileService service = getService();</div><div>            try {</div><div>                return service.getStreamVolume(profileKey, streamType);</div><div>            } catch (RemoteException e) {</div><div>                Log.e(TAG, &quot;Dead object in getStreamVolume&quot;, e);</div><div>                return UNSUPPORT_STREAM_VOLUME;</div><div>            }</div><div>        } else {</div><div>            Log.e(TAG, &quot;getStreamVolume with unsupport stream type!&quot;);</div><div>            return UNSUPPORT_STREAM_VOLUME;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets whether the phone should vibrate for incoming calls.</div><div>     *</div><div>     * @param profileKey The profile key whose DtmfTone whether enabled is returned.</div><div>     * @return The current vibration status, if enabled return true, otherwise false.</div><div>     * @see #setVibrationEnabled(boolean)</div><div>     * @internal</div><div>     */</div><div>    public boolean isVibrationEnabled(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;isVibrationEnabled with null profile key!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isVibrationEnabled(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isVibrationEnabled&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets whether tone should be played when using dial pad with the given profile key.</div><div>     *</div><div>     * @param profileKey The profile key whose DtmfTone whether enabled is returned.</div><div>     * @return The current DtmfTone status, if enabled return true, otherwise false.</div><div>     * @see #setDtmfToneEnabled(boolean)</div><div>     * @internal</div><div>     */</div><div>    public boolean isDtmfToneEnabled(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;isDtmfToneEnabled with null profile key!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isDtmfToneEnabled(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isDtmfToneEnabled&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets whether sound should be played when making screen selection.</div><div>     *</div><div>     * @param profileKey The profile key whose SoundEffect whether enabled is returned.</div><div>     * @return The current SoundEffect status, if enabled return true, otherwise false.</div><div>     * @see #setSoundEffectEnabled(boolean)</div><div>     * @internal</div><div>     */</div><div>    public boolean isSoundEffectEnabled(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;isSoundEffectEnabled with null profile key!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isSoundEffectEnabled(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isSoundEffectEnabled&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets whether sound should be played when lock or unlock screen.</div><div>     *</div><div>     * @param profileKey The profile key whose LockScreen whether enabled is returned.</div><div>     * @return The current LockScreen status, if enabled return true, otherwise false.</div><div>     * @see #setLockScreenEnabled(String, boolean)</div><div>     * @internal</div><div>     */</div><div>    public boolean isLockScreenEnabled(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;isLockScreenEnabled with null profile key!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isLockScreenEnabled(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isLockScreenEnabled&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets whether the phone should vibrate when pressing soft keys and on certain UI interactions.</div><div>     *</div><div>     * @param profileKey The profile key whose HapticFeedback whether enabled is returned.</div><div>     * @return The current HapticFeedback status, if enabled return true, otherwise false.</div><div>     * @see #setVibrateOnTouchEnabled(boolean)</div><div>     * @internal</div><div>     */</div><div>    public boolean isVibrateOnTouchEnabled(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;isVibrateOnTouchEnabled with null profile key!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isVibrateOnTouchEnabled(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isVibrateOnTouchEnabled&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets the profile state from profile states hash map with given profile key.</div><div>     *</div><div>     * @param profileKey The profile key.</div><div>     * @return The current profile state referred to given profile key.</div><div>     *</div><div>     */</div><div>    public AudioProfileState getProfileState(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;getProfileState with null profile key!&quot;);</div><div>            return null;</div><div>        }</div><div>        List&lt;String&gt; state;</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            state = service.getProfileStateString(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getProfileState&quot;, e);</div><div>            return null;</div><div>        }</div><div><br/></div><div>        String value = state.get(ProfileSettings.ringer_stream.ordinal());</div><div>        Uri voiceCallUri = (value == null ? null : Uri.parse(value));</div><div>        value = state.get(ProfileSettings.notification_stream.ordinal());</div><div>        Uri notificationUri = (value == null ? null : Uri.parse(value));</div><div>        value = state.get(ProfileSettings.videocall_Stream.ordinal());</div><div>        Uri videoCallUri = (value == null ? null : Uri.parse(value));</div><div>        value = state.get(ProfileSettings.sipcall_Stream.ordinal());</div><div>        Uri sipCallUri = (value == null ? null : Uri.parse(value));</div><div><br/></div><div>        value = state.get(ProfileSettings.ringer_volume.ordinal());</div><div>        int ringerVolume = (value == null ? 0 : Integer.valueOf(value));</div><div>        value = state.get(ProfileSettings.notification_volume.ordinal());</div><div>        int notificationVolume = (value == null ? 0 : Integer.valueOf(value));</div><div>        value = state.get(ProfileSettings.alarm_volume.ordinal());</div><div>        int alarmVolume = (value == null ? 0 : Integer.valueOf(value));</div><div><br/></div><div>        value = state.get(ProfileSettings.vibration_enabled.ordinal());</div><div>        boolean vibration = Boolean.valueOf(value);</div><div>        value = state.get(ProfileSettings.dtmftone_enabled.ordinal());</div><div>        boolean dtmfTone = Boolean.valueOf(value);</div><div>        value = state.get(ProfileSettings.soundeffect_enbled.ordinal());</div><div>        boolean soundEffect = Boolean.valueOf(value);</div><div>        value = state.get(ProfileSettings.lockscreensound_enabled.ordinal());</div><div>        boolean lockScreensound = Boolean.valueOf(value);</div><div>        value = state.get(ProfileSettings.hapticfeedback_enabled.ordinal());</div><div>        boolean hapticFeedback = Boolean.valueOf(value);</div><div><br/></div><div>        AudioProfileState profileState = new AudioProfileState.Builder(profileKey)</div><div>            .ringtone(voiceCallUri, notificationUri, videoCallUri, sipCallUri)</div><div>            .volume(ringerVolume, notificationVolume, alarmVolume)</div><div>            .vibration(vibration)</div><div>            .dtmfTone(dtmfTone)</div><div>            .soundEffect(soundEffect)</div><div>            .lockScreenSound(lockScreensound)</div><div>            .hapticFeedback(hapticFeedback)</div><div>            .build();</div><div>        Log.d(TAG, &quot;getProfileState for profileKey = &quot; + profileKey + &quot;: &quot;</div><div>                + profileState.toString());</div><div>        return profileState;</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Returns the name of given custom profile.</div><div>     *</div><div>     * @param profileKey The custom profile key.</div><div>     * @return profile name</div><div>     * @see #setProfileName(String, String)</div><div>     * @internal</div><div>     */</div><div>    public String getProfileName(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;getProfileName with null profile key!&quot;);</div><div>            return null;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getProfileName(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getProfileName&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Set methods to set profile setting to database with given profile key</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div><br/></div><div>    /**</div><div>     * Sets the {@link Uri} of the default sound for a given ring tone type and profile key.</div><div>     *</div><div>     * @param profileKey The profile key given to set ringtone uri.</div><div>     * @param type The type whose default sound should be set. One of</div><div>     *            {@link #TYPE_RINGTONE}, {@link #TYPE_NOTIFICATION},</div><div>     *             or {@link #TYPE_VIDEO_CALL}.</div><div>     * @param ringtoneUri A {@link Uri} pointing to the default sound to set.</div><div>     * @see #getRingtoneUri(Context, int)</div><div>     * @internal</div><div>     */</div><div>    public void setRingtoneUri(String profileKey, int type, Uri ringtoneUri) {</div><div>        int simId = -1;</div><div>        setRingtoneUri(profileKey, type, simId, ringtoneUri);</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Sets the {@link Uri} of the default sound for a given ring tone type and profile key.</div><div>     *</div><div>     * @param profileKey The profile key given to set ringtone uri.</div><div>     * @param type The type whose default sound should be set. One of</div><div>     *            {@link #TYPE_RINGTONE}, {@link #TYPE_NOTIFICATION},</div><div>     *             or {@link #TYPE_VIDEO_CALL}.</div><div>     * @param ringtoneUri A {@link Uri} pointing to the default sound to set.</div><div>     * @see #getRingtoneUri(Context, int)</div><div>     */</div><div>    public void setRingtoneUri(String profileKey, int type, long simId, Uri ringtoneUri) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setStreamVolume with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        if ((type != TYPE_RINGTONE) &amp;&amp; (type != TYPE_NOTIFICATION) &amp;&amp; (type != TYPE_VIDEO_CALL) &amp;&amp; (type != TYPE_SIP_CALL)) {</div><div>            Log.e(TAG, &quot;setStreamVolume with unsupport stream type!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setRingtoneUri(profileKey, type, simId, ringtoneUri);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setRingtoneUri&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Sets the volume index for a particular stream to database.</div><div>     *</div><div>     * @param profileKey The profile key given to set stream volume.</div><div>     * @param streamType The stream whose volume index should be set.</div><div>     *                   One of {@link #STREAM_RING}, {@link #STREAM_NOTIFICATION}</div><div>     *                   or {@link #STREAM_ALARM}.</div><div>     * @param index The volume index to set.</div><div>     * @see #getStreamMaxVolume(int)</div><div>     * @see #getStreamVolume(int)</div><div>     * @internal</div><div>     */</div><div>    public void setStreamVolume(String profileKey, int streamType, int index) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setStreamVolume with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        if ((streamType != STREAM_RING) &amp;&amp; (streamType != STREAM_NOTIFICATION)</div><div>                &amp;&amp; (streamType != STREAM_ALARM)) {</div><div>            Log.e(TAG, &quot;setStreamVolume with unsupport stream type!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setStreamVolume(profileKey, streamType, index);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setStreamVolume&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Sets whether the phone should vibrate for incoming calls.</div><div>     *</div><div>     * @param profileKey The profile key given to set vibration enabled.</div><div>     * @param enabled Whether vibration enabled.</div><div>     * @see #isVibrationEnabled()</div><div>     * @internal</div><div>     */</div><div>    public void setVibrationEnabled(String profileKey, boolean enabled) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setVibrationEnabled with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setVibrationEnabled(profileKey, enabled);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setVibrationEnabled&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Gets whether tone should be played when using dial pad.</div><div>     *</div><div>     * @param profileKey The profile key given to set vibration enabled.</div><div>     * @param enabled Whether DtmfTone enabled.</div><div>     * @see #isDtmfToneEnabled(boolean)</div><div>     * @internal</div><div>     */</div><div>    public void setDtmfToneEnabled(String profileKey, boolean enabled) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setDtmfToneEnabled with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setDtmfToneEnabled(profileKey, enabled);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setDtmfToneEnabled&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Sets whether sound should be played when making screen selection.</div><div>     *</div><div>     * @param profileKey The profile key given to set vibration enabled.</div><div>     * @param enabled Whether SoundEffect enabled.</div><div>     * @see #isSoundEffectEnabled()</div><div>     * @internal</div><div>     */</div><div>    public void setSoundEffectEnabled(String profileKey, boolean enabled) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setSoundEffectEnabled with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setSoundEffectEnabled(profileKey, enabled);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setSoundEffectEnabled&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Sets whether sound should be played when lock or unlock screen.</div><div>     *</div><div>     * @param profileKey The profile key given to set vibration enabled.</div><div>     * @param enabled Whether LockScreen sound enabled.</div><div>     * @see #isLockScreenEnabled(String)</div><div>     * @internal</div><div>     */</div><div>    public void setLockScreenEnabled(String profileKey, boolean enabled) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setLockScreenEnabled with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setLockScreenEnabled(profileKey, enabled);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setLockScreenEnabled&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Sets whether the phone should vibrate when pressing soft keys and on certain UI interactions.</div><div>     *</div><div>     * @param profileKey The profile key given to set vibration enabled.</div><div>     * @param enabled Whether HapticFeedback enabled.</div><div>     * @see #isVibrateOnTouchEnabled(String)</div><div>     * @internal</div><div>     */</div><div>    public void setVibrateOnTouchEnabled(String profileKey, boolean enabled) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setVibrateOnTouchEnabled with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setVibrateOnTouchEnabled(profileKey, enabled);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setVibrateOnTouchEnabled&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Sets the given profile's name.</div><div>     *</div><div>     * @param profileKey The key of the profile.</div><div>     * @param newName The new name to be set.</div><div>     * @see #getProfileName(String)</div><div>     * @internal</div><div>     */</div><div>    public void setProfileName(String profileKey, String newName) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;setProfileName with null profile key!&quot;);</div><div>            return;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.setProfileName(profileKey, newName);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setProfileName&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Other methods</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div><br/></div><div>    /**</div><div>     * Checks whether this given profile is the active one.</div><div>     *</div><div>     * @param profileKey The profile key .</div><div>     * @return True if the given profile is active, otherwise false.</div><div>     * @internal</div><div>     */</div><div>    public boolean isActiveProfile(String profileKey) {</div><div>        if (profileKey == null) {</div><div>            Log.e(TAG, &quot;isActiveProfile with null profile key!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isActiveProfile(profileKey);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isActiveProfile&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Check whether the given uri is exist</div><div>     *</div><div>     * @param uri The uri to be checked</div><div>     * @return If the uri is exist, return true, otherwise false</div><div>     */</div><div>    public boolean isRingtoneExist(Uri uri) {</div><div>        if (uri == null) {</div><div>            Log.e(TAG, &quot;isRingtoneExist with null uri!&quot;);</div><div>            return false;</div><div>        }</div><div><br/></div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.isRingtoneExist(uri);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isRingtoneExist&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Returns the maximum volume index for a particular stream.</div><div>     *</div><div>     * @param streamType The stream type whose maximum volume index is returned. Currently only</div><div>     *                   {@link #STREAM_RING}, {@link #STREAM_NOTIFICATION} and</div><div>     *                   {@link #STREAM_ALARM} are supported.</div><div>     * @return The maximum valid volume index for the stream.</div><div>     * @see #getStreamVolume(int)</div><div>     * @internal</div><div>     */</div><div>    public int getStreamMaxVolume(int streamType) {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getStreamMaxVolume(streamType);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isRingtoneExist&quot;, e);</div><div>            return UNSUPPORT_STREAM_VOLUME;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Returns the default ringtone for a particular stream.</div><div>     *</div><div>     * @param type The type whose default sound should be set. One of</div><div>     *            {@link #TYPE_RINGTONE}, {@link #TYPE_NOTIFICATION}</div><div>     *            or {@link #TYPE_VIDEO_CALL}.</div><div>     * @return The default ringtone uri.</div><div>     * @see #setRingtoneUri(String, int, Uri)</div><div>     */</div><div>    public Uri getDefaultRingtone(int type) {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getDefaultRingtone(type);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in isRingtoneExist&quot;, e);</div><div>            return null;</div><div>        }</div><div>    }</div><div><br/></div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div>    // Register a AudiopPofile listener callback to AudioProfileService</div><div>    ///////////////////////////////////////////////////////////////////////////////////////////////</div><div><br/></div><div>    /**</div><div>     * Register the AudioProfileListener to AudioProfileService to listen</div><div>     * AudioProfile changed.</div><div>     *</div><div>     * @param listener AudioProfileListener.</div><div>     * @param event The event for listener.</div><div>     * @internal</div><div>     *</div><div>     * */</div><div>    public void listenAudioProfie(AudioProfileListener listener, int event) {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            service.listenAudioProfie(listener.getCallback(), event);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in listenAudioProfie&quot;, e);</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Get the BesSurround State.</div><div>     *</div><div>     * @param</div><div>     * @return BesSurround state</div><div>     */</div><div>    public boolean getBesSurroundState() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getBesSurroundState();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getBesSurroundState&quot;, e);</div><div>            return false;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Set the BesSurround State.</div><div>     *</div><div>     * @param isEnableBes</div><div>     * @return</div><div>     */</div><div>    public int setBesSurroundState(boolean isEnableBes) {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.setBesSurroundState(isEnableBes);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setBesSurroundState&quot;, e);</div><div>            return -1;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Get the BesSurround mode.</div><div>     *</div><div>     * @param</div><div>     * @return BesSurround mode</div><div>     */</div><div>    public int getBesSurroundMode() {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.getBesSurroundMode();</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in getBesSurroundMode&quot;, e);</div><div>            return -1;</div><div>        }</div><div>    }</div><div><br/></div><div>    /**</div><div>     * Set the BesSurround mode.</div><div>     *</div><div>     * @param isEnableBes</div><div>     * @return</div><div>     */</div><div>    public int setBesSurroundMode(int besSurroundMode) {</div><div>        IAudioProfileService service = getService();</div><div>        try {</div><div>            return service.setBesSurroundMode(besSurroundMode);</div><div>        } catch (RemoteException e) {</div><div>            Log.e(TAG, &quot;Dead object in setBesSurroundMode&quot;, e);</div><div>            return -1;</div><div>        }</div><div>    }</div><div><br/></div><div>}</div><div><br/></div></span>
</div></body></html> 