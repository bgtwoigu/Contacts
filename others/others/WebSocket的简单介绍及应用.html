<html>
<head>
  <title>WebSocket的简单介绍及应用</title>
  <basefont face="Microsoft YaHei" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/301769 (zh-CN); Windows/6.3.9600 (Win64);"/>
  <style>
    body, td {
      font-family: Microsoft YaHei;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1207"/>
<h1>WebSocket的简单介绍及应用</h1>

<div>
<span><div style="box-sizing: border-box; position: relative; z-index: 3; color: rgb(51, 51, 51); font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><h1 style="box-sizing: border-box; font-size: 36px; margin: 0px; font-family: inherit; font-weight: 500; color: inherit; float: left;"><a href="https://segmentfault.com/" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; float: left; display: block; height: 54px; width: 188px; text-indent: 110%; white-space: nowrap; overflow: hidden; text-transform: capitalize; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/logo-b.svg) 0% 50% / auto 32px no-repeat;">SegmentFault</a></h1><ul style="box-sizing: border-box; margin: 12px 0px 0px 23px; float: left !important; padding-left: 0px; list-style: none;"><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: relative; margin: 0px; vertical-align: middle; color: rgb(102, 102, 102);"><a href="https://segmentfault.com/questions" style="box-sizing: border-box; color: rgb(102, 102, 102); text-decoration: none; outline: 0px; font-size: 16px; display: inline-block; padding: 0px 13px; height: 30px; border-radius: 2px; background: transparent;">问答</a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: relative; margin: 0px 0px 0px 5px; vertical-align: middle; color: rgb(102, 102, 102);"><a href="https://segmentfault.com/blogs" style="box-sizing: border-box; color: rgb(102, 102, 102); text-decoration: none; outline: 0px; font-size: 16px; display: inline-block; padding: 0px 13px; height: 30px; border-radius: 2px; background: transparent;">文章</a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: relative; margin: 0px 0px 0px 5px; vertical-align: middle; color: rgb(102, 102, 102);"><a href="https://segmentfault.com/user/note" style="box-sizing: border-box; color: rgb(102, 102, 102); text-decoration: none; outline: 0px; font-size: 16px; display: inline-block; padding: 0px 13px; height: 30px; border-radius: 2px; background: transparent;">笔记</a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: relative; margin: 0px 0px 0px 5px; vertical-align: middle; color: rgb(102, 102, 102);"><a href="https://segmentfault.com/jobs" style="box-sizing: border-box; color: rgb(102, 102, 102); text-decoration: none; outline: 0px; font-size: 16px; display: inline-block; padding: 0px 13px; height: 30px; border-radius: 2px; background: transparent;">职位</a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: relative; margin: 0px 0px 0px 5px; vertical-align: middle; color: rgb(102, 102, 102);"><a href="https://segmentfault.com/events" style="box-sizing: border-box; color: rgb(102, 102, 102); text-decoration: none; outline: 0px; font-size: 16px; display: inline-block; padding: 0px 13px; height: 30px; border-radius: 2px; background: transparent;">活动</a></li></ul><ul style="box-sizing: border-box; margin: 12px 0px 0px; float: right !important; padding-left: 0px; list-style: none;"><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: relative; margin: 0px; vertical-align: middle; color: rgb(102, 102, 102); width: 36px; height: 30px;"><a href="https://segmentfault.com/tour" style="box-sizing: border-box; color: rgb(102, 102, 102); text-decoration: none; outline: 0px; font-size: 16px; display: inline-block; padding: 0px 13px; height: 30px; border-radius: 2px; background: transparent;" target="_blank"><span style="box-sizing: border-box; position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0px; overflow: hidden; clip: rect(0px 0px 0px 0px); border: 0px;">消息</span></a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: relative; margin: 0px 0px 0px 5px; vertical-align: middle; color: rgb(102, 102, 102);"><a href="https://segmentfault.com/user/login" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none; outline: 0px; margin-left: 10px; font-size: 16px; display: inline-block; padding: 0px 13px; height: 30px; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 2px; background: rgb(0, 154, 97);">注册 · 登录</a></li></ul></div><div style="box-sizing: border-box; box-shadow: rgba(0, 0, 0, 0.239216) 0px 1px 2px 0px; color: rgb(51, 51, 51); font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(0, 95, 60);"><div style="box-sizing: border-box; margin-right: auto; margin-left: auto; padding-left: 15px; padding-right: 15px; width: 1140px;"><ul style="box-sizing: border-box; margin: 0px; height: 34px; overflow: hidden; list-style: none; padding: 0px;"><li style="box-sizing: border-box; display: inline-block; padding: 0px;"><a href="https://segmentfault.com/" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px 10px 10px 0px; white-space: nowrap; background: transparent;">home</a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px;"><a href="https://segmentfault.com/timeline" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">feed</a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px;"><a style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;"></a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/javascript" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">javascript</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/php" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">php</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/python" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">python</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/java" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">java</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/mysql" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">mysql</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/ios" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">ios</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/android" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">android</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/node.js" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">node.js</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/html5" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">html5</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/linux" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">linux</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/c%2B%2B" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">c++</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/css3" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">css3</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/git" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">git</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/golang" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">golang</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/ruby" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">ruby</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/vim" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">vim</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/docker" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">docker</a></li><li style="box-sizing: border-box; padding: 0px; display: inline-block;"><a href="https://segmentfault.com/t/mongodb" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;">mongodb</a></li><li style="box-sizing: border-box; display: inline-block; padding: 0px; position: absolute; top: 0px; right: 0px; height: 34px; width: 34px; background-color: rgb(0, 95, 60);"><a href="https://segmentfault.com/tags" style="box-sizing: border-box; color: rgb(157, 204, 182); text-decoration: none; outline: 0px; display: block; padding: 10px; white-space: nowrap; background: transparent;"></a></li></ul></div></div><div style="box-sizing: border-box; padding-bottom: 30px; position: relative; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; padding: 20px 0px; background: rgb(246, 246, 246);"><div style="box-sizing: border-box; margin-right: auto; margin-left: auto; padding-left: 15px; padding-right: 15px; width: 1140px;"><div style="box-sizing: border-box; margin-left: -15px; margin-right: -15px;"><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 855px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><span style="box-sizing: border-box; vertical-align: top; text-align: center; display: block; float: left; border: 1px solid rgb(0, 154, 97); border-radius: 50%; font-size: 16px; padding: 4px; width: 28px; height: 28px; color: rgb(0, 154, 97); font-weight: 400; margin-right: 10px; background: rgba(0, 154, 96, 0);">文</span></span></span></span><div style="box-sizing: border-box; color: rgb(153, 153, 153); margin-left: 40px; margin-bottom: -5px;"><h1 style="box-sizing: border-box; font-size: 24px; margin: 0px 0px 15px; font-family: inherit; font-weight: 500; color: inherit;"><a href="https://segmentfault.com/a/1190000004649040" style="box-sizing: border-box; color: rgb(51, 51, 51); text-decoration: none; outline: 0px; background: transparent;">WebSocket的简单介绍及应用</a></h1><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; display: inline-block; margin-right: 10px; list-style: none; padding: 0px; font-size: 0px;"><li style="box-sizing: border-box; margin-bottom: 5px; padding: 0px; font-size: 13px; display: inline-block; margin-right: 5px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/t/javascript/blogs" style="box-sizing: border-box; color: rgb(1, 126, 102); text-decoration: none; outline: 0px; display: inline-block; padding: 0px 8px; height: 24px; font-weight: 400; font-size: 13px; text-align: center; background: rgba(1, 126, 102, 0.0784314);">javascript</a></span></li><li><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"> </span></li><li style="box-sizing: border-box; margin-bottom: 5px; padding: 0px; font-size: 13px; display: inline-block; margin-right: 5px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/t/websocket/blogs" style="box-sizing: border-box; color: rgb(1, 126, 102); text-decoration: none; outline: 0px; display: inline-block; padding: 0px 8px; height: 24px; font-weight: 400; font-size: 13px; text-align: center; background: rgba(1, 126, 102, 0.0784314);">websocket</a></span></li><li><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"> </span></li><li style="box-sizing: border-box; margin-bottom: 5px; padding: 0px; font-size: 13px; display: inline-block; margin-right: 0px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/t/http/blogs" style="box-sizing: border-box; color: rgb(1, 126, 102); text-decoration: none; outline: 0px; display: inline-block; padding: 0px 8px; height: 24px; font-weight: 400; font-size: 13px; text-align: center; background: rgba(1, 126, 102, 0.0784314);">http</a></span></li></ul><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"> </span></span><div style="box-sizing: border-box; display: inline-block;"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/u/edwardup" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; margin-right: 5px; background: transparent;"><strong style="box-sizing: border-box; font-weight: 700;">EdwardUp</strong></a> 3月20日发布</span></span></div></div></div><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 285px;"><ul style="box-sizing: border-box; margin: 0px; padding-left: 0px; list-style: none; color: rgb(153, 153, 153);"><li style="box-sizing: border-box; margin-top: 0px;"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"> <strong style="box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51);">4</strong> 推荐</span></span></li><li style="box-sizing: border-box; margin-top: 10px;"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"> <strong style="box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51);">48</strong> 收藏，<strong style="box-sizing: border-box; font-weight: 400; color: rgb(51, 51, 51);">633</strong> 浏览</span></span></li></ul></div></div></div></div><div style="box-sizing: border-box; margin-right: auto; margin-left: auto; padding-left: 15px; padding-right: 15px; width: 1140px; margin-top: 30px;"><div style="box-sizing: border-box; margin-left: -15px; margin-right: -15px;"><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 855px;"><div style="box-sizing: border-box; word-wrap: break-word;"><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 0px; font-size: 1.75em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-bottom: 10px;">定时刷新的不足与改进</h2><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">web开发中可能遇到这样的场景：网页里的某一块区域里写了一些内容，但这些内容不是固定的，即使看网页的人没有做任何操作，它们也会随时间不断变化。股票行情、活动或游戏的榜单都是比较常见的例子。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">对此，一般的做法是用</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">setTimeout()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">或</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">setInverval()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">定时执行任务，任务内容是Ajax访问一次服务器，并在成功拿到返回数据后去更新页面。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">这种定时刷新的做法会有这样一些感觉不足的地方：</span></span></span></p><ul style="box-sizing: border-box; margin: 1.5em 0px 1.5em 3em; padding-left: 0px;"><li style="box-sizing: border-box; margin: 0.3em 0px;"><p style="box-sizing: border-box; margin: 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">频繁的定时网络请求对浏览器（客户端）和服务器来说都是一种负担，尤其是当网页里有多个定时刷新区域的时候。</span></span></span></p></li><li style="box-sizing: border-box; margin: 0.3em 0px;"><p style="box-sizing: border-box; margin: 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">某几次的定时任务可能是不必要的，因为服务器可能并没有新数据，还是返回了和上一次一样的内容。</span></span></span></p></li><li style="box-sizing: border-box; margin: 0.3em 0px;"><p style="box-sizing: border-box; margin: 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">页面内容可能不够新，因为服务器可能刚更新了数据，但下一轮定时任务还没有开始。</span></span></span></p></li></ul><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">造成这些不足的原因归结起来，主要还是由于服务器的响应总是被动的。HTTP协议限制了一次通信总是由客户端发起请求，再由服务器端来返回响应。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">因此，如果让服务器端也可以主动发送信息到客户端，就可以很大程度改进这些不足。WebSocket就是一个实现这种双向通信的新协议。</span></span></span></p><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.75em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-bottom: 10px;">WebSocket是基于HTTP的功能追加协议</h2><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">WebSocket最初由html5提出，但现在已经发展为一个独立的协议标准。WebSocket可以分为协议（<a href="https://tools.ietf.org/html/rfc6455" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">Protocol</a>）和<a href="https://www.w3.org/TR/websockets/" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">API</a>两部分，分别由<a href="https://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E5%B7%A5%E7%A8%8B%E4%BB%BB%E5%8A%A1%E7%BB%84" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">IETF</a>和W3C制定了标准。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">先来看看WebSocket协议的建立过程。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">为了实现WebSocket通信，首先需要客户端发起一次普通HTTP请求（也就是说，WebSocket的建立是依赖HTTP的）。请求报文可能像这样：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: inherit; overflow-wrap: normal; background: none;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">GET <span style="box-sizing: border-box; color: rgb(42, 161, 152);">ws://websocket.example.com/</span> HTTP/1.1</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Host</span>: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">websocket.example.com</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Upgrade</span>: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">websocket</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Connection</span>: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">Upgrade</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Origin</span>: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">http://example.com</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Sec-WebSocket-Key:pAloKxsGSHtpIHrJdWLvzQ==
Sec-WebSocket-Version:13</span></code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">其中HTTP头部字段</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">Upgrade: websocket</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">和</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">Connection: Upgrade</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">很重要，告诉服务器通信协议将发生改变，转为WebSocket协议。支持WebSocket的服务器端在确认以上请求后，应返回状态码为</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">101 Switching Protocols</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">的响应：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: inherit; overflow-wrap: normal; background: none;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">HTTP/1.1 <span style="box-sizing: border-box; color: rgb(42, 161, 152);">101</span> Switching Protocols</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Upgrade</span>: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">websocket</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Connection</span>: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">Upgrade</span><span style="box-sizing: border-box; color: rgb(181, 137, 0);">Sec-WebSocket-Accept</span>: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">nRu4KAPUPjjWYrnzxDVeqOxCvlM=</span></code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">其中字段</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">Sec-WebSocket-Accept</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">是由服务器对前面客户端发送的</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">Sec-WebSocket-Key</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">进行确认和加密后的结果，相当于一次验证，以帮助客户端确信对方是真实可用的WebSocket服务器。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">验证通过后，这个握手响应就确立了WebSocket连接，此后，服务器端就可以主动发信息给客户端了。此时的状态比较像服务器端和客户端接通了电话，无论是谁有什么信息想告诉对方，开口就好了。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">一旦建立了WebSocket连接，此后的通信就不再使用HTTP了，改为使用WebSocket独立的数据帧（这个帧有办法看到，见后文）。</span></span></span></p><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><br/></span></span></span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">整个过程像这样：</span></span></span></div></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><br/></span></span></span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><img src="WebSocket的简单介绍及应用_files/Image.png" type="image/png" style="height: auto;"/></div></div><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.75em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-bottom: 10px;">简单的应用示例</h2><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">应用WebSocket有这样几件事要做：</span></span></span></p><ul style="box-sizing: border-box; margin: 1.5em 0px 1.5em 3em; padding-left: 0px;"><li style="box-sizing: border-box; margin: 0.3em 0px;"><p style="box-sizing: border-box; margin: 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">选用<a href="http://caniuse.com/#feat=websockets" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">支持WebSocket的浏览器</a>。</span></span></span></p></li><li style="box-sizing: border-box; margin: 0.3em 0px;"><p style="box-sizing: border-box; margin: 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">网页内添加创建WebSocket的代码。</span></span></span></p></li><li style="box-sizing: border-box; margin: 0.3em 0px;"><p style="box-sizing: border-box; margin: 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">服务器端添加使用WebSocket通信的代码。</span></span></span></p></li></ul><h3 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.5em;">服务器端</h3><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">以Node的服务器为例，我们使用<a href="https://www.npmjs.com/package/ws" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">ws</a>这个组件，这样搭建一个支持WebSocket的服务器端：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: inherit; overflow-wrap: normal; background: none;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> request = <span style="box-sizing: border-box; color: rgb(38, 139, 210);">require</span>(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;request&quot;</span>);
<span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> dateFormat = <span style="box-sizing: border-box; color: rgb(38, 139, 210);">require</span>(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;dateformat&quot;</span>);
<span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> WebSocket = <span style="box-sizing: border-box; color: rgb(38, 139, 210);">require</span>(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;ws&quot;</span>),
    WebSocketServer = WebSocket.Server,
    wss = <span style="box-sizing: border-box; color: rgb(133, 153, 0);">new</span> WebSocketServer({
        port: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">8080</span>,
        path: <span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;/guest&quot;</span>
    });

<span style="box-sizing: border-box; color: rgb(147, 161, 161);">// 收到来自客户端的连接请求后，开始给客户端推消息</span>
wss.on(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;connection&quot;</span>, <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(ws)</span> </span>{
    ws.on(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;message&quot;</span>, <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(message)</span> </span>{
        <span style="box-sizing: border-box; color: rgb(38, 139, 210);">console</span>.log(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;received: %s&quot;</span>, message);
    });
    sendGuestInfo(ws);
});

<span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">sendGuestInfo</span><span style="box-sizing: border-box;">(ws)</span> </span>{
    request(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;http://uinames.com/api?region=china&quot;</span>,
        <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(error, response, body)</span> </span>{
            <span style="box-sizing: border-box; color: rgb(133, 153, 0);">if</span> (!error &amp;&amp; response.statusCode === <span style="box-sizing: border-box; color: rgb(42, 161, 152);">200</span>) {
                <span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> jsonObject = <span style="box-sizing: border-box; color: rgb(38, 139, 210);">JSON</span>.parse(body),
                    guest = jsonObject.name + jsonObject.surname,
                    guestInfo = {
                        guest: guest,
                        time: dateFormat(<span style="box-sizing: border-box; color: rgb(133, 153, 0);">new</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">Date</span>(), <span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;HH:MM:ss&quot;</span>)
                    };

                <span style="box-sizing: border-box; color: rgb(133, 153, 0);">if</span> (ws.readyState === WebSocket.OPEN) {

                    <span style="box-sizing: border-box; color: rgb(147, 161, 161);">// 发，送</span>
                    ws.send(<span style="box-sizing: border-box; color: rgb(38, 139, 210);">JSON</span>.stringify(guestInfo));

                    <span style="box-sizing: border-box; color: rgb(147, 161, 161);">// 用随机来“装”得更像不定时推送一些</span>
                    setTimeout(<span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">()</span> </span>{
                        sendGuestInfo(ws);
                    }, (<span style="box-sizing: border-box; color: rgb(38, 139, 210);">Math</span>.random() * <span style="box-sizing: border-box; color: rgb(42, 161, 152);">5</span> + <span style="box-sizing: border-box; color: rgb(42, 161, 152);">3</span>) * <span style="box-sizing: border-box; color: rgb(42, 161, 152);">1000</span>);
                }
            }
        });
}</code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">这个例子使用了姓名生成站点<a href="http://uinames.com/" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">uinames</a>的API服务，来生成</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">{guest: &quot;人名&quot;, time: &quot;15:26:01&quot;}</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">这样的数据。函数</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">sendGuestInfo()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">会不定时执行，并把包含姓名和时间的信息通过</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">send()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">方法发送给客户端。另外，注意</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">send()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">方法需要以字符串形式来发送json数据。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">这就像是服务器自己在做一些事，然后在需要的时候会通知客户端一些信息。</span></span></span></p><h3 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.5em;">客户端</h3><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">客户端我们使用原生javascript来完成（仅支持WebSocket的浏览器）：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: inherit; overflow-wrap: normal; background: none;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> socket = <span style="box-sizing: border-box; color: rgb(133, 153, 0);">new</span> WebSocket(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;ws://localhost:8080/guest&quot;</span>);

socket.onopen = <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(openEvent)</span> </span>{
    <span style="box-sizing: border-box; color: rgb(38, 139, 210);">console</span>.log(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;WebSocket conntected.&quot;</span>);
};

socket.onmessage = <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(messageEvent)</span> </span>{
    <span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> data = messageEvent.data,
        dataObject = <span style="box-sizing: border-box; color: rgb(38, 139, 210);">JSON</span>.parse(data);
    <span style="box-sizing: border-box; color: rgb(38, 139, 210);">console</span>.log(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;Guest at &quot;</span> + dataObject.time + <span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;: &quot;</span> + dataObject.guest);
};

socket.onerror = <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(errorEvent)</span> </span>{
    <span style="box-sizing: border-box; color: rgb(38, 139, 210);">console</span>.log(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;WebSocket error: &quot;</span>, errorEvent);
};

socket.onclose = <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(closeEvent)</span> </span>{
    <span style="box-sizing: border-box; color: rgb(38, 139, 210);">console</span>.log(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;WebSocket closed.&quot;</span>);
};</code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">WebSocket的URL格式是</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">ws://</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">与</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">wss://</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">。因此，需要注意下URL地址的写法，这也包括注意WebSocket服务器端的路径（如这里的</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">/guest</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">）等信息。因为是本地的示例所以这里是</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">localhost</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">客户端代码的流程很简单：创建</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">WebSocket</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">对象，然后指定</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">onopen</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">、</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">onmessage</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">等事件的回调即可。其中</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">onmessage</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">是客户端与服务器端通过WebSocket通信的关键事件，想要在收到服务器通知后做点什么，写在</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">onmessage</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">事件的回调函数里就好了。</span></span></span></p><h3 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.5em;">效果及分析</h3><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">通过</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">node server</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">（假定服务器端的文件名为</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">server.js</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">）启动WebSocket服务器后，用浏览器打开一个引入了前面客户端代码的html（直接文件路径</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">file:///</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">就可以），就可以得到像这样的结果：</span></span></span></p><div><br/></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><img src="WebSocket的简单介绍及应用_files/Image [1].png" type="image/png" style="height: auto;"/></div></div><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">联系前面客户端的代码可以想到，实际从创建</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">WebSocket</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">对象的语句开始，连接请求就会发送，并很快建立起WebSocket连接（不出错误的话），此后就可以收到来自服务器端的通知。如果此时客户端还想再告诉服务器点什么，这样做：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: initial; overflow-wrap: normal; word-break: break-word; background: none;">socket.send(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;Hello, server!&quot;</span>);</code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">服务器就可以收到：</span></span></span></p><div><br/></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><img src="WebSocket的简单介绍及应用_files/Image [2].png" type="image/png" style="height: auto;"/></div></div><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">当然，这也是因为前面服务器端的代码内同样设置了</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">message</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">事件的回调。在这个客户端和服务器都是javascript的例子中，无论是服务器端还是客户端，都用</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">send()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">发送信息，都通过</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">message</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">事件设置回调，形式上可以说非常一致。</span></span></span></p><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.75em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-bottom: 10px;">其他可用的数据类型</h2><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">WebSocket的</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">send()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">可以发送的消息，除了前面用的字符串类型之外，还有两种可用，它们是<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Blob" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">Blob</a>和<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">ArrayBuffer</a>。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">它们都代表二进制数据，可用于原始文件数据的发送。比如，这是一个发送Blob类型数据以完成向服务器上传图片的例子：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: inherit; overflow-wrap: normal; background: none;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> fileEl = <span style="box-sizing: border-box; color: rgb(38, 139, 210);">document</span>.getElementById(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;image_upload&quot;</span>);
<span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> file = fileEl.files[<span style="box-sizing: border-box; color: rgb(42, 161, 152);">0</span>];
socket.send(file);</code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">然后服务器端可以这样把文件保存下来：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: inherit; overflow-wrap: normal; background: none;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">var</span> fs = <span style="box-sizing: border-box; color: rgb(38, 139, 210);">require</span>(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;fs&quot;</span>);

wss.on(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;connection&quot;</span>, <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(ws)</span> </span>{
    ws.on(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;message&quot;</span>, <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(message)</span> </span>{
        fs.writeFile(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;upload.png&quot;</span>, message, <span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;binary&quot;</span>, <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span><span style="box-sizing: border-box;">(error)</span> </span>{
            <span style="box-sizing: border-box; color: rgb(133, 153, 0);">if</span> (!error) {
                <span style="box-sizing: border-box; color: rgb(38, 139, 210);">console</span>.log(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;File saved.&quot;</span>);
            }
        });
    });
});</code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">在客户端接收二进制数据时，需注意WebSocket对象有一个属性</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">binaryType</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">，初始值为</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">&quot;blob&quot;</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">。因此，如果接收的二进制数据是</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">ArrayBuffer</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">，应在接收之前这样做：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: initial; overflow-wrap: normal; word-break: break-word; background: none;">socket.binaryType = <span style="box-sizing: border-box; color: rgb(42, 161, 152);">&quot;arraybuffer&quot;</span>;</code></pre><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.75em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-bottom: 10px;">其他WebSocket服务器端</h2><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">其他语言来做WebSocket服务器是怎样的呢？下面是一个php的WebSocket服务器的例子（使用<a href="http://socketo.me/" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">Ratchet</a>）：</span></span></span></p><pre style="box-sizing: border-box; overflow: auto; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; display: block; padding: 1em; margin: 1.5em 0px; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/blueprint.png) rgb(246, 246, 246);"><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 1em; color: inherit; padding: 0px; border-radius: 0px; white-space: inherit; overflow-wrap: normal; background: none;"><span style="box-sizing: border-box; color: rgb(203, 75, 22);">&lt;?php</span><span style="box-sizing: border-box; color: rgb(133, 153, 0);">use</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">Ratchet</span>\<span style="box-sizing: border-box; color: rgb(38, 139, 210);">ConnectionInterface</span>;
<span style="box-sizing: border-box; color: rgb(133, 153, 0);">use</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">Ratchet</span>\<span style="box-sizing: border-box; color: rgb(38, 139, 210);">MessageComponentInterface</span>;

<span style="box-sizing: border-box; color: rgb(133, 153, 0);">require</span> <span style="box-sizing: border-box; color: rgb(133, 153, 0);">__DIR__</span> . <span style="box-sizing: border-box; color: rgb(42, 161, 152);">'/vendor/autoload.php'</span>;

<span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">class</span> <span style="box-sizing: border-box; color: rgb(181, 137, 0);">GuestServer</span> <span style="box-sizing: border-box; color: rgb(133, 153, 0);">implements</span> <span style="box-sizing: border-box; color: rgb(181, 137, 0);">MessageComponentInterface</span> </span>{

    <span style="box-sizing: border-box; color: rgb(133, 153, 0);">public</span> <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">onOpen</span><span style="box-sizing: border-box;">(ConnectionInterface <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$conn</span>)</span> </span>{
        <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$conn</span>-&gt;send(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'The server is listening to you now.'</span>);
    }

    <span style="box-sizing: border-box; color: rgb(133, 153, 0);">public</span> <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">onMessage</span><span style="box-sizing: border-box;">(ConnectionInterface <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$conn</span>, <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$msg</span>)</span> </span>{
        <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$conn</span>-&gt;send(<span style="box-sizing: border-box; color: rgb(181, 137, 0);">$this</span>-&gt;generateGuestInfo());
    }

    <span style="box-sizing: border-box; color: rgb(133, 153, 0);">public</span> <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">onClose</span><span style="box-sizing: border-box;">(ConnectionInterface <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$conn</span>)</span> </span>{
    }

    <span style="box-sizing: border-box; color: rgb(133, 153, 0);">public</span> <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">onError</span><span style="box-sizing: border-box;">(ConnectionInterface <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$conn</span>, \Exception <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$e</span>)</span> </span>{
        <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$conn</span>-&gt;close();
    }

    <span style="box-sizing: border-box; color: rgb(133, 153, 0);">private</span> <span style="box-sizing: border-box;"><span style="box-sizing: border-box; color: rgb(133, 153, 0);">function</span> <span style="box-sizing: border-box; color: rgb(38, 139, 210);">generateGuestInfo</span><span style="box-sizing: border-box;">()</span> </span>{
        <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$jsonString</span> = file_get_contents(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'http://uinames.com/api?region=china'</span>);
        <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$jsonObject</span> = json_decode(<span style="box-sizing: border-box; color: rgb(181, 137, 0);">$jsonString</span>, <span style="box-sizing: border-box; color: rgb(133, 153, 0);">true</span>);
        <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$guest</span> = <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$jsonObject</span>[<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'name'</span>] . <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$jsonObject</span>[<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'surname'</span>];
        <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$guestInfo</span> = <span style="box-sizing: border-box; color: rgb(133, 153, 0);">array</span>(
            <span style="box-sizing: border-box; color: rgb(42, 161, 152);">'guest'</span> =&gt; <span style="box-sizing: border-box; color: rgb(181, 137, 0);">$guest</span>,
            <span style="box-sizing: border-box; color: rgb(42, 161, 152);">'time'</span> =&gt; date(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'H:i:s'</span>, time()),
        );

        <span style="box-sizing: border-box; color: rgb(133, 153, 0);">return</span> json_encode(<span style="box-sizing: border-box; color: rgb(181, 137, 0);">$guestInfo</span>);
    }
}

<span style="box-sizing: border-box; color: rgb(181, 137, 0);">$app</span> = <span style="box-sizing: border-box; color: rgb(133, 153, 0);">new</span> Ratchet\App(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'localhost'</span>, <span style="box-sizing: border-box; color: rgb(42, 161, 152);">8080</span>);
<span style="box-sizing: border-box; color: rgb(181, 137, 0);">$app</span>-&gt;route(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'/guest'</span>, <span style="box-sizing: border-box; color: rgb(133, 153, 0);">new</span> GuestServer(), <span style="box-sizing: border-box; color: rgb(133, 153, 0);">array</span>(<span style="box-sizing: border-box; color: rgb(42, 161, 152);">'*'</span>));
<span style="box-sizing: border-box; color: rgb(181, 137, 0);">$app</span>-&gt;run();</code></pre><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">这个例子也同样是由服务器返回</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">{guest: &quot;人名&quot;, time: &quot;15:26:01&quot;}</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">的json数据，不过由于php不像Node那样可以用</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">setTimeout()</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">很容易地实现异步定时任务，这里改为在客户端发送一次任意信息后，再去uinames取得信息并返回。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">也可以看到，php搭建的WebSocket服务器仍然是近似的，主要通过WebSocket的</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">open</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">、</span></span></span><code style="box-sizing: border-box; font-family: &apos;Source Code Pro&apos;, Consolas, Menlo, Monaco, &apos;Courier New&apos;, monospace; font-size: 0.93em; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; white-space: pre; background-color: rgb(249, 242, 244);">message</code><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">等事件来实现功能。</span></span></span></p><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.75em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-bottom: 10px;">在Chrome开发工具中查看WebSocket数据帧</h2><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">Chrome开发工具中选择Network，然后找到WebSocket的那个请求，里面可以选择Frames。在Frames里看到的，就是WebSocket的数据帧了：</span></span></span></p><div><br/></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><img src="WebSocket的简单介绍及应用_files/Image [3].png" type="image/png" style="height: auto;"/></div></div><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">可以看到很像聊天记录，其中用浅绿色标注的是由客户端发送给服务器的部分。</span></span></span></p><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin: 1.5em 0px 0px; font-size: 1.75em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-bottom: 10px;">结语</h2><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">总的来说，把服务器和客户端拉到了一个聊天窗口来办事，这确实是很棒的想法。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">即使只从形式上说，WebSocket的事件回调感觉也比定时任务用起来要更亲切一些。</span></span></span></p><p style="box-sizing: border-box; margin: 1.5em 0px 0px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">（重新编辑自我的博客，原文地址：<a href="http://acgtofe.com/posts/2016/03/websocket-how-to" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">http://acgtofe.com/posts/2016/03/websocket-how-to</a>）</span></span></span></p></div><div style="box-sizing: border-box; margin-top: 10px;"><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 10.5px; float: left !important; padding-left: 0px; list-style: none; margin-left: -5px;"><li style="box-sizing: border-box; display: inline-block; padding-left: 5px; padding-right: 5px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040" style="box-sizing: border-box; color: rgb(119, 119, 119); text-decoration: none; outline: 0px; background: transparent;">3月20日发布</a></span></span></span></li></ul></div><div style="box-sizing: border-box; text-align: center; margin-top: 10px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"> </span></span></span></div><div style="box-sizing: border-box; border-top-width: 1px; border-top-style: solid; border-top-color: rgb(221, 221, 221); margin-top: 40px; margin-bottom: 30px; padding-top: 30px;"><div style="box-sizing: border-box; margin-left: -15px; margin-right: -15px;"><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 570px;"><h4 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin-top: 0px; margin-bottom: 10.5px; font-size: 18px;">你可能感兴趣的文章</h4><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 10.5px; padding-left: 0px; list-style: none;"><li style="box-sizing: border-box; margin-bottom: 8px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000000382788" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; margin-right: 6px; word-break: break-word; background: transparent;" title="WebSocket入门">WebSocket入门</a> <small style="box-sizing: border-box; font-size: 13px; color: rgb(119, 119, 119); display: inline-block;">18 收藏，4.7k 浏览</small></span></span></span></li><li style="box-sizing: border-box; margin-bottom: 8px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000002589132" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; margin-right: 6px; word-break: break-word; background: transparent;" title="判断浏览器是否支持 Web Sockets">判断浏览器是否支持 Web Sockets</a> <small style="box-sizing: border-box; font-size: 13px; color: rgb(119, 119, 119); display: inline-block;">3 收藏，768 浏览</small></span></span></span></li><li style="box-sizing: border-box; margin-bottom: 8px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000003007199" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; margin-right: 6px; word-break: break-word; background: transparent;" title="LeanEngine 中使用 WebSocket">LeanEngine 中使用 WebSocket</a> <small style="box-sizing: border-box; font-size: 13px; color: rgb(119, 119, 119); display: inline-block;">1 收藏，282 浏览</small></span></span></span></li></ul></div><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 284.984px;"><div style="box-sizing: border-box;"><div style="box-sizing: border-box; color: rgb(119, 119, 119);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">本文采用 <a href="http://creativecommons.org/licenses/by/3.0/cn" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank">知识共享署名 3.0 中国大陆许可协议</a>，可自由转载、引用，但需署名作者且注明文章出处 。</span></span></div></div></div></div></div><h2 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin-top: 10.5px; margin-bottom: 15px; font-size: 18px; padding-top: 20px; border-top-width: 2px; border-top-style: solid; border-top-color: rgb(204, 204, 204);">讨论区</h2><div style="box-sizing: border-box; list-style: none; margin: 0px 0px 15px; font-size: 13px; color: rgb(102, 102, 102); padding: 10px; border-radius: 2px; background-color: rgb(246, 246, 246);"><div style="box-sizing: border-box; margin-left: -15px; margin-right: -15px;"><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 835px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">请先 <a style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;">登录</a> 后评论</span></div></div></div></div><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 285px;"><div style="box-sizing: border-box;"><div style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><ins style="box-sizing: border-box;"><a href="https://sponsor.segmentfault.com/ck.php?oaparams=2__bannerid=8__zoneid=2__cb=a272f8df7e__oadest=http%3A%2F%2Fclick.aliyun.com%2Fm%2F4199%2F" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;" target="_blank"><img src="WebSocket的简单介绍及应用_files/Image.jpg" type="image/jpeg" border="0" height="165" style="box-sizing: border-box; border: 0px; vertical-align: middle; margin-bottom: 25px; height: auto;" width="255"/></a><div style="box-sizing: border-box; position: absolute; left: 0px; top: 0px; visibility: hidden;"><span style="color: rgb(51, 51, 51);"><ins style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><ins style="box-sizing: border-box;"><ins style="box-sizing: border-box;"><ins style="box-sizing: border-box;"><img height="0" src="https://sponsor.segmentfault.com/lg.php?bannerid=8&amp;campaignid=1&amp;zoneid=2&amp;loc=https%3A%2F%2Fsegmentfault.com%2Fa%2F1190000004649040&amp;cb=a272f8df7e" style="box-sizing: border-box; border: 0px; vertical-align: middle; width: 0px; height: 0px;" width="0"></img></ins></ins></ins></span></ins></span></div></ins></span></span></span></div></div><div style="box-sizing: border-box; margin: 0px 0px 25px; padding-top: 0px; border: none;"><p style="box-sizing: border-box; margin: 0px 0px 10.5px; color: rgb(119, 119, 119);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">本文隶属于专栏</span></span></p><h4 style="box-sizing: border-box; font-family: inherit; font-weight: 500; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 16px;"><a href="https://segmentfault.com/blog/yardtea" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; background: transparent;">庭院茶</a></h4><p style="box-sizing: border-box; margin: 0px 0px 10.5px; word-break: break-word;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">天津大学毕业生，从事前端开发。爱好动画，也喜欢做设计，现在画师学习中。个人博客 http://acgtofe.com</span></span></span></p><div style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/u/edwardup" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; background: transparent;"><img src="WebSocket的简单介绍及应用_files/Image [1].jpg" type="image/jpeg" alt="EdwardUp" style="box-sizing: border-box; border: 0px; vertical-align: middle; border-top-left-radius: 50%; border-top-right-radius: 50%; border-bottom-right-radius: 50%; border-bottom-left-radius: 50%; width: 40px; float: left; margin-right: 10px; height: auto;"/><span style="box-sizing: border-box;">EdwardUp</span></a><span style="box-sizing: border-box; color: rgb(119, 119, 119);">作者</span></span></span></span></div></div><div style="box-sizing: border-box; margin-bottom: 20px;"><div style="box-sizing: border-box; margin-bottom: 10px;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">分享扩散：</span></span></span></div><div style="box-sizing: border-box; float: left; color: rgb(153, 153, 153); font-size: 13px; display: block;"><ul style="box-sizing: border-box; margin: 0px; list-style: none; display: inline; padding: 0px; vertical-align: text-bottom;"><li style="box-sizing: border-box; display: inline-block; margin-right: 5px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: inline-block; width: 28px; height: 28px; vertical-align: middle; border-radius: 2px; text-indent: 110%; white-space: nowrap; overflow: hidden; text-transform: capitalize; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/social-icons/icon-sn.svg) -56px -28px / auto 56px no-repeat transparent;">新浪微博</a></span></li><li style="box-sizing: border-box; display: inline-block; margin-right: 5px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: inline-block; width: 28px; height: 28px; vertical-align: middle; border-radius: 2px; text-indent: 110%; white-space: nowrap; overflow: hidden; text-transform: capitalize; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/social-icons/icon-sn.svg) -252px -28px / auto 56px no-repeat transparent;">微信</a></span></li><li style="box-sizing: border-box; display: inline-block; margin-right: 5px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: inline-block; width: 28px; height: 28px; vertical-align: middle; border-radius: 2px; text-indent: 110%; white-space: nowrap; overflow: hidden; text-transform: capitalize; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/social-icons/icon-sn.svg) -112px -28px / auto 56px no-repeat transparent;">Twitter</a></span></li><li style="box-sizing: border-box; display: inline-block; margin-right: 5px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: inline-block; width: 28px; height: 28px; vertical-align: middle; border-radius: 2px; text-indent: 110%; white-space: nowrap; overflow: hidden; text-transform: capitalize; background: url(https://sf-static.b0.upaiyun.com/v-56fa5b80/global/img/social-icons/icon-sn.svg) -140px -28px / auto 56px no-repeat transparent;">Facebook</a></span></li></ul></div><a style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none; outline: 0px; display: inline-block; margin-bottom: 0px; font-weight: 400; text-align: center; vertical-align: middle; cursor: pointer; border: none; white-space: nowrap; padding: 0px; font-size: 12px; border-radius: 3px; box-shadow: none; background: none transparent;" type="button"></a></div><div style="box-sizing: border-box; display: block; padding: 10px 0px; border-top-width: 1px; border-top-style: solid; border-top-color: rgb(238, 238, 238); width: 255px; top: 0px; background: rgb(255, 255, 255);"><div style="box-sizing: border-box; margin: 0px; border: none; border-radius: 3px; box-shadow: rgb(255, 255, 255) 0px 0px 0px; top: 0px; position: relative; max-width: 250px; background-color: rgb(255, 255, 255);"><div style="box-sizing: border-box; padding: 8px 12px; border: none; border-top-right-radius: 2px; border-top-left-radius: 2px; color: rgb(51, 51, 51); font-weight: 700; cursor: initial; font-size: 16px; background-color: rgb(255, 255, 255);"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;">文章目录</span></div><div style="box-sizing: border-box; padding: 0px 0px 10px; max-height: inherit; overflow: hidden; transition: all 0.2s ease; position: relative; z-index: 2;"><div style="box-sizing: border-box; position: relative; padding: 0px 12px; top: 0px;"><ul style="box-sizing: border-box; margin: 0px; position: relative; z-index: 2; padding-left: 18px; list-style-type: square;"><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader0" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">定时刷新的不足与改进</a></span></span></span></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader1" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">WebSocket是基于HTTP的功能追加协议</a></span></span></span></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader2" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">简单的应用示例</a></span></span></span></li><li style="list-style: none; display: inline"><ul style="box-sizing: border-box; margin: 0px; padding-left: 18px; list-style-type: square;"><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader3" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">服务器端</a></span></span></span></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader4" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">客户端</a></span></span></span></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader5" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">效果及分析</a></span></span></span></li></ul></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader6" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">其他可用的数据类型</a></span></span></span></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader7" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">其他WebSocket服务器端</a></span></span></span></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader8" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">在Chrome开发工具中查看WebSocket数据帧</a></span></span></span></li><li style="box-sizing: border-box;"><span style="color: rgb(51, 51, 51);"><span style="font-size: 14px;"><span style="font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif;"><a href="https://segmentfault.com/a/1190000004649040#articleHeader9" style="box-sizing: border-box; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; display: block; padding: 3px 0px; background: transparent;">结语</a></span></span></span></li></ul></div></div></div></div></div></div></div></div><div style="box-sizing: border-box; margin-right: auto; margin-left: auto; padding-left: 15px; padding-right: 15px; width: 1140px;"><div style="box-sizing: border-box; margin-left: -15px; margin-right: -15px;"><dl style="box-sizing: border-box; margin: 0px 0px 40px; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 190px;"><dt style="box-sizing: border-box; font-weight: 700; margin-bottom: 20px; color: rgb(51, 51, 51);">网站相关</dt><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/about" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">关于我们</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/tos" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">服务条款</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/faq" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">帮助中心</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/repu" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">声望与权限</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/markdown" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">编辑器语法</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://weekly.segmentfault.com/" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">每周精选</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/app" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">App 下载</a></dd></dl><dl style="box-sizing: border-box; margin: 0px 0px 40px; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 190px;"><dt style="box-sizing: border-box; font-weight: 700; margin-bottom: 20px; color: rgb(51, 51, 51);">联系合作</dt><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/contact" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">联系我们</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/hiring" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">加入我们</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/link" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">合作伙伴</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/press" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">媒体报道</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://board.segmentfault.com/" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">建议反馈</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="http://pan.baidu.com/share/link?shareid=604288&amp;uk=839272106" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">Logo 下载</a></dd></dl><dl style="box-sizing: border-box; margin: 0px 0px 40px; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 190px;"><dt style="box-sizing: border-box; font-weight: 700; margin-bottom: 20px; color: rgb(51, 51, 51);">常用链接</dt><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://chrome.google.com/webstore/detail/segmentfault-%E7%AC%94%E8%AE%B0/pjklfdmleagfaekibdccmhlhellefcfo" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">笔记插件: Chrome</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://addons.mozilla.org/zh-CN/firefox/addon/sf-note-ext/" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">笔记插件: Firefox</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;">订阅：<a href="https://segmentfault.com/feeds" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">问答</a> / <a href="https://segmentfault.com/feeds/blogs" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">文章</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://mirrors.segmentfault.com/" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">SF 文档镜像</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/blog/interview" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">SF 社区访谈</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/d-day" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">技术沙龙D-DAY</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/hackathon" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">黑客马拉松Hackathon</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://namebeta.com/" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">域名搜索注册</a></dd></dl><dl style="box-sizing: border-box; margin: 0px 0px 40px; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 190px;"><dt style="box-sizing: border-box; font-weight: 700; margin-bottom: 20px; color: rgb(51, 51, 51);">关注我们</dt><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://github.com/SegmentFault" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">Github</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://twitter.com/segment_fault" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">Twitter</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://weibo.com/segmentfault" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">新浪微博</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/blog/segmentfault_team" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">SF 团队日志</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/blog/segmentfault" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">产品技术日志</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/blog/community_admin" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">社区运营日志</a></dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://segmentfault.com/blog/segmentfault_news" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">市场运营日志</a></dd></dl><dl style="box-sizing: border-box; margin: 0px 0px 40px; position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; float: left; width: 379.984px;"><dt style="box-sizing: border-box; font-weight: 700; margin-bottom: 20px; color: rgb(51, 51, 51);">内容许可</dt><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;">除特别说明外，用户内容均采用 <a href="http://creativecommons.org/licenses/by-sa/3.0/cn/" rel="license" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">知识共享署名-相同方式共享 3.0 中国大陆许可协议</a> 进行许可</dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;">本站由 <a href="https://www.upyun.com/?utm_source=segmentfault&amp;utm_medium=link&amp;utm_campaign=upyun&amp;md=segmentfault" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;" target="_blank">又拍云</a> 提供 CDN 存储服务</dd><dd style="box-sizing: border-box; margin: 5px 0px; font-size: 13px;"><a href="https://mixpanel.com/f/partner" rel="nofollow" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;"><img src="WebSocket的简单介绍及应用_files/Image [4].png" type="image/png" alt="Mobile Analytics" height="24" style="box-sizing: border-box; border: 0px; vertical-align: middle;"/></a></dd></dl></div><div style="box-sizing: border-box; text-align: center; font-size: 13px;">Copyright © 2011-2016 SegmentFault. 当前呈现版本 16.03.22<br style="box-sizing: border-box;"/><a href="http://www.miibeian.gov.cn/" rel="nofollow" style="box-sizing: border-box; color: rgb(136, 136, 136); text-decoration: none; outline: 0px; background: transparent;">浙ICP备15005796号-2</a></div><p style="box-sizing: border-box; margin: 0px 0px 10.5px; text-align: center;"></p></div><div style="box-sizing: border-box; right: 40px; bottom: 40px; border: 1px solid rgb(221, 221, 221); width: 36px; text-align: center; border-radius: 2px; z-index: 1000; color: rgb(51, 51, 51); font-family: &apos;Helvetica Neue&apos;, Helvetica, Arial, &apos;PingFang SC&apos;, &apos;Hiragino Sans GB&apos;, &apos;WenQuanYi Micro Hei&apos;, &apos;Microsoft Yahei&apos;, sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(255, 255, 255);position:relative;"><div style="box-sizing: border-box; position: relative;"><div><br/></div></div></div></span>
</div></body></html> 